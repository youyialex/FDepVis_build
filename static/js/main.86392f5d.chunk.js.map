{"version":3,"sources":["redux/state.js","redux/reducers.js","redux/index.js","redux/actions.js","views/ScatterPlot/index.js","views/FamilySelector/index.js","views/FamilyTree/index.js","views/AttributesHeatmap/index.js","views/DetailInfo/index.js","Dashboard.js","index.js"],"names":["state","familyInfo","key","ID","people","SNum","focusFamily","focusPID","selectedFamily","reducers","preState","action","type","id","filter","d","modifyFocusFa","console","log","length","store","createStore","composeWithDevTools","actions","addFamily","removeFamily","selectFamily","selectPerson","ScatterPlot","props","data","subscribe","drawChart","this","uploadData","_this","axios","get","then","res","setState","selectedF","getState","d3","remove","points","indexOf","fid","width","document","getElementById","clientWidth","height","clientHeight","innerWidth","innerHeight","margin","svg","append","attr","x","domain","Math","max","map","range","y","rangeRound","z","fig","focusPerson","$tooltip","selectAll","enter","pid","style","on","transition","duration","coordinates","html","dispatch","legend","i","each","text","className","class","Component","FamilySelector","dataSource","columns","title","dataIndex","setFocus","nodes","getElementsByClassName","getAttribute","classList","add","e","tag","value","aElements","getElementsByTagName","aEle","push","onRow","record","onClick","event","node","getElementByAttr","nclasses","rowClassName","size","pagination","hideOnSinglePage","defaultPageSize","FamilyTree","makeKey","drawHorPro","graphicOpt","graphicOpt_radialC","color","prototype","moveToFront","parentNode","appendChild","isRight","dataLists","listTree","holders","call","updateHoders","p","holder","pn","div","select","cluster","root","parentId","parent","linksGenerator","links","descendants","datainput","group","spouse","children","pp","clinical_data","rad","par","floor","sex","container","coupleholder","is_suicide","is_deceased","cli_d","count","graphicopt","barHeight","g","arc","innerRadius","outerRadius","sqrt","classed","drawRadialChart","drawTree","exit","createHolder","colors","AttributesHeatmap","names","attrs","attrsmap","allTimes","values","setData","innerHTML","data_count","row","myData","objNum","Object","slice","reduce","a","b","j","col","times","data_keys","keys","item","forEach","gridSize","height1","height2","tooltip","svg1","axisWidth","xScale","axis","ticks","yScale","gs","container1","container2","cards","opacity","overflowX","DetailInfo","img","Sex","Birth_Year","Death_Year","BMI","Suicide_Weapon","Death_Cause","suicide_glyphs","bdate","ddate","maxbmi","toPrecision","weapon","cause_death","sex_icon","bmi","new_width","new_height","age","overflow","justify","align","span","paddingTop","padding","Item","label","src","Dashboard","backgroundColor","textAlign","href","ReactDOM","render"],"mappings":"kaA+DeA,EA/DD,CACVC,WAAY,CACR,CACIC,IAAK,GACLC,GAAI,GACJC,OAAQ,IACRC,KAAM,IAEV,CACIH,IAAK,IACLC,GAAI,IACJC,OAAQ,IACRC,KAAM,IAEV,CACIH,IAAK,MACLC,GAAI,MACJC,OAAQ,IACRC,KAAM,IAEV,CACIH,IAAK,MACLC,GAAI,MACJC,OAAQ,GACRC,KAAM,IAEV,CACIH,IAAK,MACLC,GAAI,MACJC,OAAQ,IACRC,KAAM,IAEV,CACIH,IAAK,OACLC,GAAI,OACJC,OAAQ,IACRC,KAAM,IAEV,CACIH,IAAK,OACLC,GAAI,OACJC,OAAQ,IACRC,KAAM,IAEV,CACIH,IAAK,OACLC,GAAI,OACJC,OAAQ,IACRC,KAAM,IAEV,CACIH,IAAK,OACLC,GAAI,OACJC,OAAQ,GACRC,KAAM,IAIdC,YAAa,MACbC,SAAU,MACVC,eAAgB,CAAC,GAAI,IAAK,MAAO,QC3BtBC,EA/BE,WAA6B,IAA5BC,EAA2B,uDAAlBV,EAAOW,EAAW,uCACzC,OAAOA,EAAOC,MACV,IAAK,aACD,OAAO,2BACAF,GADP,IAEIF,eAAe,GAAD,mBAAME,EAASF,gBAAf,CAA+BG,EAAOE,KACpDP,YAAaK,EAAOE,KAE5B,IAAK,gBACD,OAAO,2BACAH,GADP,IAEIF,eAAgBE,EAASF,eAAeM,QAAO,SAACC,GAAK,OAAOA,IAAMJ,EAAOE,MACzEP,YAAaU,EAAcN,EAAUC,KAE7C,IAAK,gBACD,OAAO,2BACAD,GADP,IAEIJ,YAAaK,EAAOE,KAE5B,IAAK,gBACD,OAAO,2BACAH,GADP,IAEIH,SAAUI,EAAOE,KAEzB,QACI,OAAO,eACAH,KAOnB,SAASM,EAAcN,EAAUC,GAE7B,OADAM,QAAQC,IAAIR,EAASF,eAAeE,EAASF,eAAeW,OAAO,IAC5DT,EAASF,eAAeE,EAASF,eAAeW,OAAO,KAAOR,EAAOE,GAAKH,EAASF,eAAeE,EAASF,eAAeW,OAAO,GAAGT,EAASF,eAAeE,EAASF,eAAeW,OAAO,G,aC7BvLC,EAFDC,sBAAYZ,EACtBa,iCCuBWC,EA7BC,CACZC,UAAW,SAASX,GAChB,MAAO,CACHD,KAAM,aACNC,OAGRY,aAAc,SAASZ,GACnB,MAAO,CACHD,KAAM,gBACNC,OAGRa,aAAc,SAASb,GACnB,MAAO,CACHD,KAAM,gBACNC,OAIRc,aAAc,SAASd,GACnB,MAAO,CACHD,KAAM,gBACNC,QCfSe,E,kDAEjB,WAAYC,GAAO,IAAD,8BACd,cAAMA,IACD7B,MAAQ,CACT8B,KAAM,CACF,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,EAAE,GACN,CAAC,EAAE,GAAG,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,EAAE,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,EAAE,GAAG,GACN,CAAC,GAAG,GAAG,GACP,CAAC,IAAI,GAAG,GACR,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,EAAE,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,EAAE,GAAG,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,EAAE,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,EAAE,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,EAAE,GAAG,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,EAAE,GACN,CAAC,IAAI,GAAG,GACR,CAAC,GAAG,GAAG,GACP,CAAC,IAAI,GAAG,GACR,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,EAAE,GAAG,GACN,CAAC,GAAG,EAAE,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,EAAE,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,EAAE,GAAG,GACN,CAAC,IAAI,GAAG,GACR,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,EAAE,GAAG,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,EAAE,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,EAAE,GAAG,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,EAAE,GAAG,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,EAAE,GACN,CAAC,GAAG,GAAG,GACP,CAAC,EAAE,GAAG,GACN,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,GAAG,GACP,CAAC,GAAG,EAAE,GACN,CAAC,GAAG,GAAG,KAvGD,E,gEA4GE,IAAD,OACfV,EAAMW,WAAU,WACZ,EAAKC,eAETC,KAAKC,e,mCAIL,IAAMC,EAAQF,KACdG,IAAMC,IAAI,0CACRC,MAAK,SAACC,GAEJ,IAAIT,EAAOS,EAAIT,KAEfK,EAAMK,SACF,CACIV,KAAMA,IACP,WAECK,EAAMH,oB,kCAKlB,IAAIS,EAAYrB,EAAMsB,WAAWlC,eACjCmC,IAAU,oBAAoBC,SAC9B,IAAMC,EAASZ,KAAKjC,MAAM8B,KAAKhB,QAAO,SAAAC,GAAC,OAAgC,IAA9B0B,EAAUK,QAAQ/B,EAAEgC,QAGvDC,EAAQC,SAASC,eAAe,eAAeC,YAC/CC,EAASH,SAASC,eAAe,eAAeG,aAAe,GAC/DC,EAAaN,EAJJ,GACK,GAIdO,EAAcH,EAASI,GAEvBC,EAAMd,IAAU,gBACLe,OAAO,OACPC,KAAK,sBAAuB,iBAC5BA,KAAK,UAAW,OAASX,EAAO,IAAKI,GAElDQ,EAAIjB,MACHkB,OAAO,CAAC,EAAGC,KAAKC,IAAL,MAAAD,KAAI,YAAQjB,EAAOmB,KAAI,SAAAjD,GAAC,OAAIA,EAAE6C,SACzCK,MAAM,CAAC,EAAGX,IAEXY,EAAIvB,MACHwB,WAAW,CAAC,EAAGZ,IACfM,OAAO,CAACC,KAAKC,IAAL,MAAAD,KAAI,YAAQjB,EAAOmB,KAAI,SAAAjD,GAAC,OAAIA,EAAEmD,OAAK,IAE5CE,EAAIzB,MACCkB,OAAO,CAAC,KAAM,MAAO,QAAS,QAAS,QAAS,SAAU,SAAU,SAAU,WAC9EI,MAAM,CAAC,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,YAE5FI,EAAMZ,EAAIC,OAAO,KAChBC,KAAK,YAAa,oBACnBW,EAAclD,EAAMsB,WAAWnC,SAG/BgE,EAAW5B,IAAU,iBACzB0B,EAAIX,OAAO,KACNc,UAAU,UAEV1C,KAAKe,GACL4B,QACAf,OAAO,UACPC,KAAK,SAAU,WACfA,KAAK,UAAU,SAAA5C,GAAC,OAAEA,EAAE2D,KAAOJ,EAAa,QAASF,EAAErD,EAAEgC,QACrDY,KAAK,eAAgB,KACrBA,KAAK,QAAQ,SAAS5C,GACnB,OAAOqD,EAAErD,EAAEgC,QAEdY,KAAK,MAAM,SAAS5C,GACjB,OAAO6C,EAAE7C,EAAE6C,MAEdD,KAAK,MAAM,SAAS5C,GACjB,OAAOmD,EAAEnD,EAAEmD,MAEdP,KAAK,IAAK,GACVgB,MAAM,UAAU,OAChBC,GAAG,aAAa,SAAS7D,GACtB4B,IAAUV,MACL0C,MAAM,UAAW,GAEtBJ,EAASM,aACJC,SAAS,KACTH,MAAM,UAAW,IAEtB,IAAII,EAAcpC,IAASV,MAC3BsC,EAASS,KAAM,eAAiBjE,EAAEgC,IAAnB,oBAAqDhC,EAAE2D,KACjEC,MAAM,OAASI,EAAY,GAAG,GAAI,MAClCJ,MAAM,MAAQI,EAAY,GAAI,SAEtCH,GAAG,YAAY,SAAS7D,GACrB4B,IAAUV,MACL0C,MAAM,UAAW,IAEtBJ,EAASM,aACAC,SAAS,KACTH,MAAM,UAAW,MAE7BC,GAAG,SAAS,SAAS7D,GAClBK,EAAM6D,SAAStE,EAAOe,aAAaX,EAAEgC,MACrC3B,EAAM6D,SAAStE,EAAOgB,aAAaZ,EAAE2D,SAG7C,IAAIQ,EAASb,EACRX,OAAO,KACPC,KAAK,cAAe,SACpBA,KAAK,YAAa,QAClBA,KAAK,cAAc,OACnBA,KAAK,YALG,oBAKuBL,EAAYE,GAAU,GAL7C,QAMRG,KAAK,cAAe,SACpBa,UAAU,KACV1C,KAAKV,EAAMsB,WAAWlC,gBACtBiE,QACAf,OAAO,KACPC,KAAK,aAAa,SAAS5C,EAAGoE,GAC3B,MAAO,eAAqB,GAAJA,EAAS,OAEpCP,GAAG,SAAS,SAAA7D,GACTK,EAAM6D,SAAStE,EAAOe,aAAaX,OAEtC4C,KAAK,SAAU,WAGhBrD,EAAcc,EAAMsB,WAAWpC,YACnC4E,EAAOE,MAAK,SAASrE,GACdA,IAAMT,GACLqC,IAAUV,MACLyB,OAAO,QACPiB,MAAM,OAAQ,QACdhB,KAAK,QAAS,IACdA,KAAK,SAAU,IACfgB,MAAM,UAAW,OACjBhB,KAAK,KAAM,GACXA,KAAK,KAAM,GACXA,KAAK,KAAM,GACXgB,MAAM,eAAgB,OAGnCO,EACKxB,OAAO,UACPC,KAAK,IAAK,GACVA,KAAK,KAAM,GACXA,KAAK,KAAM,GACXA,KAAK,OAAQS,GACbO,MAAM,WAAW,SAAA5D,GAAC,OAAEA,IAAMT,EAAa,IAAK,SAEjD4E,EACKxB,OAAO,QACPC,KAAK,IAAK,IACVA,KAAK,KAAM,IACX0B,MAAK,SAAStE,GACX,MAAO,IAAMA,KAEhB4C,KAAK,QAAQ,SAAA5C,GAAC,OAAGA,IAAMT,EAAa,OAAQ,Y,+BAKjD,OACI,sBAAKO,GAAG,cAAcyE,UAAU,OAAhC,UACI,qBAAKA,UAAU,SAAf,0BACA,qBAAKC,MAAM,wB,GA/QcC,a,kBCFpBC,E,kDAEjB,WAAY5D,GAAQ,IAAD,8BACf,cAAMA,IACD7B,MAAQ,CACT0F,WAAY,GACZC,QAAS,CACL,CACIC,MAAO,KACPC,UAAW,KACX3F,IAAK,MAET,CACI0F,MAAO,SACPC,UAAW,SACX3F,IAAK,UAET,CACI0F,MAAO,OACPC,UAAW,OACX3F,IAAK,UAlBF,E,gEAuBC,IAAD,OACf+B,KAAKO,SAAS,CACVkD,WAAYtE,EAAMsB,WAAWzC,aAC9B,WACC,EAAK6F,cAET1E,EAAMW,WAAU,WACZ,EAAK+D,gB,iCAKT,IAAIxF,EAAcc,EAAMsB,WAAWpC,YAC/ByF,EAAQ9C,SAAS+C,uBAAuB,iBAC5C/E,QAAQC,IAAI6E,GACZ,IAAI,IAAIZ,EAAI,EAAGA,EAAIY,EAAM5E,OAAQgE,IAAI,CACvBY,EAAMZ,GAAGc,aAAa,iBACtB3F,EACNyF,EAAMZ,GAAGe,UAAUC,IAAI,WAEvBJ,EAAMZ,GAAGe,UAAUtD,OAAO,c,iCAI3BwD,GACPnF,QAAQC,IAAIkF,K,uCAGCC,EAAI1C,EAAK2C,GAGtB,IAFA,IAAIC,EAAUtD,SAASuD,qBAAqBH,GACxCI,EAAK,GACDtB,EAAE,EAAEA,EAAEoB,EAAUpF,OAAOgE,IAExBoB,EAAUpB,GAAGc,aAAatC,IAAO2C,GAChCG,EAAKC,KAAMH,EAAUpB,IAE7B,OAAOsB,I,+BAED,IAAD,OACL,OACI,sBAAK5F,GAAG,iBAAiByE,UAAU,OAAnC,UACI,qBAAKA,UAAU,SAAf,6BACA,cAAC,IAAD,CACIqB,MAAO,SAAAC,GACH,MAAO,CACHC,QAAS,SAAAC,GACL7F,QAAQC,IAAI0F,GACZ,IAAIG,EAAO,EAAKC,iBAAiB,KAAM,eAAgBJ,EAAO1G,KAAK,GAC/D+G,EAAWF,EAAKd,aAAa,UACG,GAAjCgB,EAASnE,QAAQ,aAChBiE,EAAKb,UAAUC,IAAI,YACnB/E,EAAM6D,SAAStE,EAAOa,UAAUoF,EAAOzG,OAEJ,GAAhC8G,EAASnE,QAAQ,YAChBiE,EAAKb,UAAUC,IAAI,WACnB/E,EAAM6D,SAAStE,EAAOe,aAAakF,EAAOzG,OAE1C4G,EAAKb,UAAUtD,OAAO,YACtBxB,EAAM6D,SAAStE,EAAOc,aAAamF,EAAOzG,SAM9D+G,aAAc,SAAAN,GACV,OAAiE,IAAzDxF,EAAMsB,WAAWlC,eAAesC,QAAQ8D,EAAO1G,KAAc,WAAa,IAEtFwF,WAAYzD,KAAKjC,MAAM0F,WAAYC,QAAS1D,KAAKjC,MAAM2F,QAASwB,KAAK,QACrEC,WAAY,CACRC,kBAAkB,EAClBC,gBAAiB,a,GA/FG9B,aCAvB+B,G,yDAEnB,WAAY1F,GAAO,IAAD,8BAChB,cAAMA,IACD7B,MAAQ,CACXM,YAAa,IAHC,E,gEAME,IAAD,OACjB2B,KAAKuF,UACLpG,EAAMW,WAAU,WACZ,EAAKG,gBAETD,KAAKC,e,mCAGO,IAAD,OAEL5B,EAAcc,EAAMsB,WAAWpC,YACrC8B,IAAMC,IAAI,gDAAmD/B,GAC3DgC,MAAK,SAACC,GACJ,IAAIT,EAAOS,EAAIT,KACf,EAAKU,SAAS,CACVlC,YAAaA,IAEjB,EAAKmH,WAAW3F,Q,iCAKXA,GAGL,IAGI4F,EAAa,CACf1E,MAJYC,SAASC,eAAe,cAAcC,YAKlDC,OAJaH,SAASC,eAAe,cAAcG,aAAa,GAAG,GAKnEG,OAAQ,IAGNmE,EAAqB,CACrB3E,MAAM,GACNI,OAAO,GACPwE,MAAOjF,MAEFsB,MAAM,CAAC,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,aAGhLtB,IAAakF,UAAUC,YAAc,WACjC,OAAO7F,KAAKmD,MAAK,WACbnD,KAAK8F,WAAWC,YAAY/F,UAGpC,IAIkBgG,EAJdC,EAAW,GAKbA,IADgBD,EAFT,IAGe,CAACpH,GAAI,SAASoH,EAAUnG,KAAKA,GAKrD,SAAsBqG,GACpB,IAAIC,EAAUzF,IAAU,eACnB6B,UAAU,iBACV1C,KAAKqG,GAAU,SAAApH,GAAC,OAAEA,EAAEF,MACpBwH,KAAKC,GAQV,SAASA,EAAaC,GAClB,OAAOA,EAAE5E,KAAK,MAAK,SAAA5C,GAAC,OAAEA,EAAEF,MACnBuE,MAAK,SAASrE,IAIzB,SAAkByH,EAAQ1G,EAAM4F,GAE9B,IAAI1E,EAAQ0E,EAAW1E,MACnBI,EAASsE,EAAWtE,OACpBI,EAASkE,EAAWlE,OACpBiF,EAAK3G,EAAKX,OAAS,GAAG,EAAGW,EAAKX,OAAO,GAErCuH,EAAM/F,IAAU6F,GACpBE,EAAIC,OAAO,OAAO/F,SAClB,IAAIa,EAAMiF,EACChF,OAAO,OACPC,KAAK,KAAM,WACXA,KAAK,QAASX,EAAMyF,GACpB9E,KAAK,SAAUP,GACfM,OAAO,KACPC,KAAK,QAAQ,WACbA,KAAK,YAAa,aAAeH,EAAS,IAAMA,EAAS,KACpEC,EAAIe,UAAU,KAAK5B,SAEnB,IAAIgG,EAAUjG,MAETwE,KAAK,CAACnE,EAAMyF,EAAU,EAAPjF,EAAUJ,EAAc,EAAPI,IAGjCqF,EAAOlG,MACN9B,IAAG,SAAUE,GACV,OAAOA,EAAEF,MAEZiI,UAAS,SAAU/H,GAChB,OAAOA,EAAEgI,SALNpG,CAONb,GAEL8G,EAAQC,GAGR,IAAIG,EAAiBrG,MACEiB,GAAE,SAAS7C,GAAK,OAAOA,EAAE6C,KACzBM,GAAE,SAASnD,GAAK,OAAOA,EAAEmD,KAGhDT,EAAIe,UAAU,QACT1C,KAAK+G,EAAKI,SACVxE,QACAf,OAAO,QACPC,KAAK,IAAKqF,GACVrE,MAAM,OAAQ,QACdhB,KAAK,SAAU,QAIpB,IAAIoD,EAAOtD,EAAIe,UAAU,SACpB1C,KAAK+G,EAAKK,eACVzE,QACAf,OAAO,KACPC,KAAK,QAAS,QACdA,KAAK,aAAa,SAAU5C,GACzB,MAAO,aAAeA,EAAE6C,EAAG,IAAK7C,EAAEmD,EAAI,OAI1CI,EAAclD,EAAMsB,WAAWnC,SAEnCwG,EAAKvC,UAAU,UAAU1C,MAAK,SAAAf,GAC1B,IAAIoI,EAAU,GASd,OAPIA,EADiB,eAAjBpI,EAAEe,KAAKsH,MACK,CAAC,CAAClJ,IAAK,MAAO4B,KAAM,CAACf,EAAEe,QAEvB,CAAC,CAAC5B,IAAK,OAAQ4B,KAAM,CAACf,EAAEe,OAAQ,CAAC5B,IAAK,SAAU4B,KAAMf,EAAEe,KAAKuH,SAC1EtI,EAAEe,KAAKwH,UACRH,EAAUzC,KAAK,CAACxG,IAAK,WAAY4B,KAAMf,EAAEe,KAAKwH,WAGzCH,EAAUrI,QAAO,SAAAyH,GAAC,OAAIA,EAAEzG,KAAKhB,QAAO,SAAAyI,GAAE,OAAKA,EAAGC,uBACpD/E,QACAf,OAAO,KACPC,KAAK,aAAY,SAAA5C,GAChB,IAAI0I,EAAgB,eAAV1I,EAAEb,IAAqB,EAAE,EAC/BwJ,EAAgB,eAAV3I,EAAEb,IAAqB,IAAI,IACjC0D,EAAI,EAAGM,EAAI,EAQf,MAPa,WAAVnD,EAAEb,MACD0D,EAAI6F,EAAIC,GAEC,aAAV3I,EAAEb,MACD0D,GAAK7C,EAAEe,KAAKX,OAAO,GAAK,EAAKJ,EAAEe,KAAKX,OAAO,EAAGsI,EAAIA,EAAI,EAAI3F,KAAK6F,MAAO5I,EAAEe,KAAKX,OAAO,GAAIsI,EACxFvF,EAAI,IAEF,aAAN,OAAoBN,EAApB,aAA0BM,EAA1B,QAEDM,UAAU,KACV1C,MAAK,SAAAf,GAAC,OAAIA,EAAEe,QACZ2C,QACAf,OAAO,KACPC,KAAK,aAAY,SAAC5C,EAAGoE,GACpB,IAAIsE,EAAkB,eAAZ1I,EAAEqI,MAAuB,EAAE,EAEjCxF,EAAIuB,EAAEsE,GADY,eAAZ1I,EAAEqI,MAAuB,IAAI,KACpBlF,EAAI,EAKvB,MAJa,MAAVnD,EAAE6I,MACDhG,GAAK6F,EACLvF,GAAKuF,GAEH,aAAN,OAAoB7F,EAApB,aAA0BM,EAA1B,QAEDU,GAAG,aAAY,SAAS7D,GACrBwD,EAASM,aACJC,SAAS,KACTH,MAAM,UAAW,KAEtB,IAAIK,EAAO,OAASjE,EAAEF,GAAK,QAEvBkE,EAAcpC,IAASkH,GAE3BtF,EAASS,KAAKA,GACTL,MAAM,OAASI,EAAY,GAAG,GAAI,MAClCJ,MAAM,MAAQI,EAAY,GAAG,GAAI,SAEvCH,GAAG,YAAW,WAEbL,EAASM,aACAC,SAAS,KACTH,MAAM,UAAW,MAE7BS,MAAK,SAASrE,GACX,IAAI+I,EAAgBnH,IAAUV,MAC1BwH,EAAkB,eAAZ1I,EAAEqI,MAAuB,EAAE,EACxB,MAAVrI,EAAE6I,IACHE,EAAapG,OAAO,UACPC,KAAK,IAAK8F,GAEvBK,EAAapG,OAAO,QACPC,KAAK,QAAa,EAAJ8F,GACd9F,KAAK,SAAc,EAAJ8F,MAGjC9E,MAAM,QAAQ,SAAU5D,GACrB,MAAoB,KAAhBA,EAAEgJ,WACK,MAEU,KAAjBhJ,EAAEiJ,YACK,QAEA,aAIdrG,KAAK,SAAU,QACfgB,MAAM,eAAgB,IAE3B,IAAIJ,EAAW5B,IAAU,iBACrBkH,EAAYlH,IAAU,eAAeoE,OACzCA,EACKvC,UAAU,kBAAkB1C,MAAK,SAAAf,GAOhC,OALqB,eAAjBA,EAAEe,KAAKsH,MACK,CAAC,CAAClJ,IAAK,MAAO4B,KAAMf,EAAEe,OAEtB,CAAC,CAAC5B,IAAK,OAAQ4B,KAAMf,EAAEe,MAAO,CAAC5B,IAAK,SAAU4B,KAAMf,EAAEe,KAAKuH,OAAO,MAEjEvI,QAAO,SAAAyH,GAAC,OAAIA,EAAEzG,KAAK0H,oBACnC/E,QACAf,OAAO,KACPC,KAAK,QAAQ,gBACbA,KAAK,aAAY,SAAA5C,GAChB,IAAI0I,EAAgB,eAAV1I,EAAEb,IAAqB,EAAE,EAC/BwJ,EAAkB,eAAZ3I,EAAEqI,MAAuB,IAAI,IACnCxF,EAAI,EAAGM,EAAI,EAIf,MAHa,WAAVnD,EAAEb,MACH0D,EAAI6F,EAAIC,GAEJ,aAAN,OAAoB9F,EAApB,aAA0BM,EAA1B,QAEDP,KAAK,SAAU,WACfA,KAAK,aAAa,SAAA5C,GAAC,OAAEA,EAAEe,KAAKjB,IAAMyD,EAAa,WAAY,cAC3DM,GAAG,aAAY,SAAS7D,GAClBA,EAAEe,KAAKjB,IAAMyD,GACd3B,IAAUV,KAAK8F,YAAYD,cAC3BnF,IAAUV,MAAM0G,OAAO,KAAKhF,KAAK,YAAY,aAE7ChB,IAAUV,MAAM0G,OAAO,KAAKhF,KAAK,YAAY,YAG/CY,EAASM,aACJC,SAAS,KACTH,MAAM,UAAW,KAEtB,IAAIK,EAAO,OAASjE,EAAEe,KAAKjB,GAAK,QAC5BoJ,EAAQtH,IAAW5B,EAAEe,KAAK0H,eAC1BU,EAAQ,EACZ,IAAK,IAAI/E,KAAK8E,EAAM,CAClB,IAAI/J,EAAM+J,EAAM9E,GAAGjF,IACfoG,EAAQ2D,EAAM9E,GAAGmB,MACN,IAAVA,IACDtB,GAAQ,wFAA0F2C,EAAmBC,MAAM1H,GAAO,YAAcA,EAAM,KAAOoG,EAC7J4D,KAIN,IAAInF,EAAcpC,IAASkH,GAE3BtF,EAASS,KAAKA,GACTL,MAAM,OAASI,EAAY,GAAG,GAAI,MAClCJ,MAAM,MAAQI,EAAY,GAAS,GAANmF,EAAS,GAAI,SAEhDtF,GAAG,YAAW,WACbjC,IAAUV,MAAM0G,OAAO,KAAKhF,KAAK,YAAY,YAE7CY,EAASM,aACAC,SAAS,KACTH,MAAM,UAAW,MAE7BC,GAAG,SAAS,SAAS7D,GAClBK,EAAM6D,SAAStE,EAAOgB,aAAaZ,EAAEe,KAAKjB,QAE7CuE,MAAK,SAASrE,IAQvB,YAAmD,IAAzByH,EAAwB,EAAxBA,OAAQzH,EAAgB,EAAhBA,EAAGoJ,EAAa,EAAbA,WAG/BC,GAFQD,EAAWnH,MACVmH,EAAW/G,OACC,GACrBwE,EAAQuC,EAAWvC,MACnByC,EAAI7B,EAAO9E,OAAO,KAElB5B,EAAOa,MAAS2D,OAAM,SAAAvF,GAAC,OAAEA,EAAEuF,QAApB3D,CAA2BA,IAAW5B,EAAEyI,gBAE/Cc,EAAM3H,MACL4H,YAAY,GACZC,YAAYJ,GAEJ,MAAVrJ,EAAE6I,KACHU,EAAIE,YAAY1G,KAAK2G,KAAK,GAAGL,GAC7BC,EAAE3G,OAAO,UACJC,KAAK,IAAKG,KAAK2G,KAAK,GAAGL,GAC5BC,EAAE3G,OAAO,QACAC,KAAK,KAAMyG,GACXzG,KAAK,KAAMyG,GACXzG,KAAK,QAAmB,EAAVyG,GACdzG,KAAK,SAAoB,EAAVyG,GACfzF,MAAM,OAAQ,SACdA,MAAM,SAAU,OAChBA,MAAM,eAAgB,IAG/B0F,EAAE3G,OAAO,YACJC,KAAK,KAAM,aACXD,OAAO,QACPC,KAAK,KAAMyG,GACXzG,KAAK,KAAMyG,GACXzG,KAAK,QAAmB,EAAVyG,GACdzG,KAAK,SAAoB,EAAVyG,GACpBC,EAAE1G,KAAK,YAAa,oBAEpB0G,EAAE3G,OAAO,UACJC,KAAK,IAAKyG,GACVM,QAAQ,SAAS,GACjB/F,MAAM,OAAQ,SACdA,MAAM,SAAU,OAChBA,MAAM,eAAgB,IAId0F,EAAE7F,UAAU,QACxB1C,KAAKA,GACL2C,QAAQf,OAAO,QACfiB,MAAM,QAAQ,SAAU5D,GACrB,OAAO6G,EAAM7G,EAAEe,KAAK5B,QAEvByD,KAAK,IAAK2G,GAzDHK,CAAgB,CAACnC,OAAQ7F,IAAUV,MAClBlB,EAAGA,EAAEe,KACLqI,WAAYxC,OA7NbiD,CAAS,IAAI7J,EAAEF,GAAIE,EAAEe,KAAM4F,MATrDU,EAAQyC,OAAOjI,SACfwF,EACK3D,QACAf,OAAO,OACPC,KAAK,QAAQ,aACb0E,KAAKC,GAdVwC,CAAa5C,K,gCA4SjB,IACIlF,EAAQC,SAASC,eAAe,cAAcC,YADhC,GAOd4H,EAAS,CAAC,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,UAAU,WAE1K3B,EAAQzG,IAAU,cACTgB,KAAK,SAAU,IACfA,KAAK,QAASX,GACdU,OAAO,KACPC,KAAK,QAAS,WACda,UAAU,KACV1C,KAbF,CACP,UAAU,YAAY,qBAAqB,mBAAoB,SAC/D,2BAA2B,aAAa,uBAAuB,uBAAuB,yBACtF,KAAK,2BAA2B,UAAU,iBAAiB,OAAO,SAAS,sBAWlE2C,QACAf,OAAO,KAAKC,KAAK,QAAS,aAC1BA,KAAK,aAAa,SAAC5C,EAAGoE,GAAJ,0BAAqB,GAAMA,EAAE,EAAG,IAAhC,aAAwD,GAAhBrB,KAAK6F,MAAMxE,EAAE,GAArD,QAC/BiE,EACK1F,OAAO,QACPC,KAAK,QAAS,IACdA,KAAK,SAAU,IACfA,KAAK,KAAM,GACXgB,MAAM,QAAQ,SAAC5D,EAAGoE,GAAJ,OAAQ4F,EAAO5F,MAClCiE,EAAM1F,OAAO,QACRC,KAAK,IAAK,SACVA,KAAK,KAAM,IACXgB,MAAM,YAAa,QACnBU,MAAK,SAAAtE,GAAC,OAAEA,O,+BAIX,OACE,mCACE,sBAAKF,GAAG,aAAayE,UAAU,OAA/B,UACI,sBAAKA,UAAU,SAAf,4BAAwCrD,KAAKjC,MAAMM,eACnD,qBAAKiF,MAAM,aAAX,SACE,qBAAK1E,GAAG,gBAEV,qBAAK0E,MAAM,0B,GAjZaC,cCEnBwF,G,yDAEnB,WAAYnJ,GAAQ,IAAD,8BACjB,cAAMA,IACD7B,MAAQ,CACXiL,MAAO,CAAC,KAAM,KAAM,KAAM,KAAM,MAChCC,MAAO,CAAC,UAAW,YAAa,qBAAsB,mBAAoB,SAAU,2BAA4B,aAAc,uBAAwB,uBAAwB,yBAA0B,KAAM,2BAA4B,UAAW,iBAAkB,OAAQ,SAAU,qBAEzRC,SAAU,CACR,QAAW,EACX,UAAa,EACb,qBAAsB,EACtB,mBAAoB,EACpB,OAAU,EACV,2BAA4B,EAC5B,WAAc,EACd,uBAAwB,EACxB,uBAAwB,EACxB,yBAA0B,EAC1B,GAAM,GACN,2BAA4B,GAC5B,QAAW,GACX,eAAkB,GAClB,KAAQ,GACR,OAAU,GACV,oBAAqB,IAIvBC,SAAU,CAAC,EAAG,EAAG,GAEjBC,OAAQ,IA7BO,E,gEAkCE,IAAD,OAClBjK,EAAMW,WAAU,WACd,EAAKG,gBAEPD,KAAKC,e,mCAIO,IAAD,OACL5B,EAAcc,EAAMsB,WAAWpC,YACrC8B,IAAMC,IAAI,8CAAqD/B,GAAagC,MAAK,SAACC,GAChF,IAAIT,EAAOS,EAAIT,KAEf,EAAKwJ,QAAQxJ,GACbmB,SAASC,eAAe,YAAYqI,UAAY,GAChDtI,SAASC,eAAe,WAAWqI,UAAY,GAC/C,EAAKvJ,iB,8BAIDF,GAQN,IANA,IAgCI0J,EAhCAC,EAAM,EACNC,EAAS,GAETT,EAAQ,GAGH9F,EAAI,EAAGA,EAAIrD,EAAKX,OAAQgE,IAAK,CAEpC,IAAIwG,EAASC,OAAOP,OAAOvJ,EAAKqD,IAAIrE,QAAO,SAACwF,GAC1C,MAAwB,kBAAVA,KAKhB,GAAc,KAHdqF,EAASA,EAAOE,MAAM,IAEHC,QAAO,SAACC,EAAGC,GAAJ,OAAUD,EAAIC,IAAG,GAC1B,CACff,EAAMvE,KAAK5E,EAAKqD,GAAGT,KACnB,IAAIuH,GAAK,EACT,IAAK,IAAI/L,KAAO4B,EAAKqD,GAEf8G,GAAK,GACPP,EAAOhF,KAAK,CACV+E,IAAKA,EACLS,IAAKD,EACLE,MAAOrK,EAAKqD,GAAGjF,KAGnB+L,IAEFR,KAMJ,GAAI3J,EAAKX,OAAQ,CACf,IAAIiL,EAAYR,OAAOS,KAAKvK,EAAK,IAAIhB,QAAO,SAAAwL,GAAI,MAAI,CAAC,MAAO,OAAOxJ,QAAQwJ,GAAQ,KACnFd,EAAa,IAAII,OACjBQ,EAAUG,SAAQ,SAAAnG,GAChBoF,EAAWpF,GAAKtE,EAAKkC,KAAI,SAAAsI,GACvB,OAAOA,EAAKlG,MACX0F,QAAO,SAACC,EAAGC,GAAJ,OAAUD,EAAIC,IAAG,MAM/B,IAAIZ,EAAWQ,OAAOP,OAAOG,GAAYxH,KAAI,SAAAsC,GAAK,OAAIA,KAGtDrE,KAAKO,SAAS,CACZ6I,OAAQK,EACRT,MAAOA,EACPG,SAAUA,M,kCAID,IAAD,OAGJjJ,EAAQF,KACRe,EAAQC,SAASC,eAAe,qBAAqBC,YAIrDqJ,EAAmB,IAARxJ,EAAe,GAG1BI,EAASnB,KAAKjC,MAAMiL,MAAM9J,OAASqL,EAAW,GAC9CC,EAAsE,IAA5DxJ,SAASC,eAAe,qBAAqBG,aAWzD8I,EAAQlK,KAAKjC,MAAMqL,OAAOrH,KAAI,SAAAsI,GAChC,OAAOA,EAAKH,SAKRvE,EAAQjF,MACXkB,OAAO,CAAC,EAAGlB,IAAOwJ,KAElBlI,MAAM,CAAC,QAAS,YAWbyI,EAAoB,EAAVD,EAAc,GACjB9J,IAAU,aAAae,OAAO,OACxCC,KAAK,QAASX,GAAOW,KAAK,SAAU+I,GACpC/I,KAAK,KAAM,YAGMD,OAAO,KAGHc,UAAU,eAC/B1C,KAAKG,KAAKjC,MAAMkL,OAChBzG,QACAf,OAAO,KACPC,KAAK,aAAa,SAAC5C,EAAGoE,GAAJ,0BAAuBA,EAAIqH,EAAiB,KAANxJ,EAAcwJ,EAAS,EAA7D,aAAmEE,EAAnE,QAEVhJ,OAAO,QACf2B,MAAK,SAAAtE,GAAC,OAAIA,KACV4C,KAAK,YAAa,OAClBA,KAAK,OAAQ,WACbA,KAAK,YAAa,eASrB,IAAMgJ,EAAUhK,IAAU,oBAGpBiK,EAAOjK,IAAU,aAAae,OAAO,OACxCC,KAAK,QAASX,GAAOW,KAAK,SAAU8I,EAAU,GAK7CI,EAAoB,IAAR7J,EACZ8J,EAASnK,MACVkB,OAAO,CAAC,EAAG,KACXI,MAAM,CAAC,EAAG4I,IAETE,EAAOpK,IAAcmK,GACtBE,MAAM,IAMHC,GAJML,EAAKlJ,OAAO,KACrBC,KAAK,YADI,oBAC4B,KAANX,EADtB,aACsCyJ,EADtC,MAETpE,KAAK0E,GAEOpK,MACZkB,OAAO,CAAC,EAAGlB,IAAOV,KAAKjC,MAAMoL,YAC7BnH,MAAM,CAACwI,EAAS,KAMbS,EAJIN,EAAKlJ,OAAO,KACnBC,KAAK,YADE,oBAC8B,KAANX,EADxB,SAIGwB,UAAU,QACpB1C,KAAKG,KAAKjC,MAAMoL,UAChB3G,QACAf,OAAO,KACPC,KAAK,QAAS,OAKbwJ,GADYxK,IAAU,sBAAsBoE,OAC/BpE,IAAU,aAAaoE,QACpCqG,EAAazK,IAAU,YAAYoE,OAGvCmG,EAAGxJ,OAAO,QACPC,KAAK,KAAK,SAAU5C,EAAGoE,GAEtB,OAAOqH,EAAWrH,EAAe,MAAXqH,KAEvB7I,KAAK,KAAK,SAAU5C,GAEnB,OAAOkM,EAAOlM,MAGf4C,KAAK,SAAS,WACb,MAAkB,KAAX6I,KAER7I,KAAK,UAAU,SAAU5C,GAExB,OAAO0L,EAAUQ,EAAOlM,MAEzB4C,KAAK,OAAQ,WACbiB,GAAG,aAAa,SAAU7D,EAAGoE,GAC5B,IAAIJ,EAAcpC,IAASwK,GAC3BR,EAAQhI,MAAM,OAASI,EAAY,GAAK,GAAM,MAC3CJ,MAAM,MAAQI,EAAY,GAAK,GAAM,MACrCJ,MAAM,UAAW,gBACjBK,KAAK7C,EAAMnC,MAAMkL,MAAM/F,GAAlBhD,WAAyCpB,GAC9C4D,MAAM,UAAW,OAErBC,GAAG,YAAY,SAAU7D,GACxB4L,EAAQhI,MAAM,UAAW,QAAQA,MAAM,UAAW,MAQtD,IAAMlB,EAAMd,IAAU,YAAYe,OAAO,OACtCC,KAAK,QAASX,GAAOW,KAAK,SAAUP,GACpCO,KAAK,KAAM,WAIVW,EAAclD,EAAMsB,WAAWnC,SAsB7B8M,GArBa5J,EAAIC,OAAO,KAC3BC,KAAK,QAAS,aACdA,KAAK,YAAa,iBAAmB,EAAI6I,EAAW,GAAK,KACzDhI,UAAU,QACV1C,KAAKG,KAAKjC,MAAMiL,OAChBxG,QACAf,OAAO,QACP2B,MAAK,SAAAtE,GAAC,OAAIA,KACV4C,KAAK,IAAK,GACVA,KAAK,KAAK,SAAU5C,EAAGoE,GACtB,OAAOA,EAAIqH,KAEZ7I,KAAK,YAAa,SAClBA,KAAK,SAAU,WACfA,KAAK,QAAQ,SAAA5C,GAAC,OAAGA,GAAKuD,EAAY,UAAW,aAC7CM,GAAG,SAAS,SAAC7D,GACVK,EAAM6D,SAAStE,EAAOgB,aAAaZ,OAK3B0C,EAAIC,OAAO,KACtBC,KAAK,YADM,oBAC0B,KAANX,EADpB,SAEXW,KAAK,QAAS,aACda,UAAU,QACV1C,KAAKG,KAAKjC,MAAMqL,QAChB5G,SAKHxD,QAAQC,IAAIe,KAAKjC,MAAMqL,QAEJgC,EAAM3J,OAAO,QAC7BC,KAAK,KAAK,SAAU5C,EAAGoE,GACtB,MAAe,IAARnC,EAAe,GAAKjC,EAAEmL,IAAM,KAEpCvI,KAAK,KAAK,SAAU5C,GACnB,OAAQA,EAAE0K,IAAOe,KAElB7I,KAAK,KAAM,GACXA,KAAK,KAAM,GACXA,KAAK,QAAS6I,EAAW,GACzB7I,KAAK,SAAU6I,EAAW,GAC1B7I,KAAK,UAAU,SAAA5C,GAAC,OAAE,EAAKf,MAAMiL,MAAMlK,EAAE0K,MAAQnH,EAAa,QAAS,UACnEX,KAAK,gBAAgB,SAAA5C,GAAC,OAAc,GAAXA,EAAEoL,MAAY,IAAI,SAC3CxH,MAAM,QAAQ,SAAU5D,GACvB,OAAO6G,EAAM7G,EAAEoL,UAEhBxI,KAAK,SAAU,WACfiB,GAAG,SAAS,SAAC7D,GACVK,EAAM6D,SAAStE,EAAOgB,aAAa,EAAK3B,MAAMiL,MAAMlK,EAAE0K,UAEzD7G,GAAG,aAAa,SAAU7D,EAAGoE,GAC5B,IAAIJ,EAAcpC,IAASyK,GAI3BT,EAAQhI,MAAM,OAASI,EAAY,GAAK,GAAM,MAC3CJ,MAAM,MAAQI,EAAY,GAAK,IAAO,MACtCJ,MAAM,UAAW,gBACjBK,KAAK7C,EAAMnC,MAAMkL,MAAMnK,EAAEmL,KAAO,OAASnL,EAAEoL,OAC3CxH,MAAM,UAAW,OAGrBC,GAAG,YAAY,SAAU7D,GACxB4L,EAAQhI,MAAM,UAAW,QAAQA,MAAM,UAAW,Q,+BAWlD1C,KAAKJ,MADPC,KAEF,OACA,qCACI,qBAAKwD,UAAY,SAAjB,kCAEA,sBAAKzE,GAAK,oBACVyE,UAAY,OADZ,UAGA,qBAAKA,UAAY,kBACjBX,MACE,CACE2I,QAAS,GAHb,eAOA,qBAAKzM,GAAK,WAAV,eAEA,qBAAKA,GAAK,UACV8D,MACE,CACE4I,UAAW,UAHf,eAZA,c,GA/VuC/H,c,kBCF1BgI,E,kDACjB,WAAY3L,GAAQ,IAAD,8BACf,cAAMA,IACD7B,MAAQ,CACTG,GAAI,OACJsN,IAAI,qBACJ3L,KAAM,CACF3B,GAAI,IACJuN,IAAK,IACLC,WAAY,KACZC,WAAY,KACZC,IAAK,GACLC,eAAgB,OAChBC,YAAY,kCACZC,eAAe,KAbR,E,gEAuBE,IAAD,OAChB5M,EAAMW,WAAU,WACZ,EAAKG,gBAETD,KAAKC,e,mCAIK,IAAD,OACH3B,EAAWa,EAAMsB,WAAWnC,SAClC6B,IAAMC,IAAI,gDAAuD9B,GAC/D+B,MAAK,SAACC,GACJ,IAAIT,EAAOS,EAAIT,KACfb,QAAQC,IAAI,aAAcY,GAI1B,EAAKU,SAAS,CACVrC,GAAI,OAAS2B,EAAK4C,IAClB+I,IAAK,SAAW3L,EAAKkM,eAAiB,OACtClM,KAAM,CACF3B,GAAI2B,EAAK4C,IACTgJ,IAAK5L,EAAK8H,IACV+D,WAAY7L,EAAKmM,MAAMpC,MAAM,EAAE,GAC/B+B,WAAY9L,EAAKoM,MAAMrC,MAAM,EAAE,GAC/BgC,IAAK/L,EAAKqM,OAAOC,YAAY,GAC7BN,eAAgBhM,EAAKuM,OACrBN,YAAajM,EAAKwM,eAO1B,EAAKtM,iB,kCAOT,IAIIuM,EACsB,KAAvBtM,KAAKjC,MAAM8B,KAAK4L,IACfa,EANa,4sBAOiB,KAAvBtM,KAAKjC,MAAM8B,KAAK4L,MACvBa,EANe,w+BAQnBtL,SAASC,eAAe,QAAQqI,UAAYgD,EAE5C,IAAMnL,EAASH,SAASC,eAAe,QAAQG,aACzCL,EAAQC,SAASC,eAAe,QAAQC,YAE1CqL,EAAMvM,KAAKjC,MAAM8B,KAAK+L,IAEf,GAAPW,IACAA,EAAM,IAIV,IAAIC,EAAYzL,GAASwL,EAAM,IAC3BE,EAAsB,GAATtL,EACjBnC,QAAQC,IAAIsN,EAAM,GAAIC,GAEK,KAAvBxM,KAAKjC,MAAM8B,KAAK4L,IACpB/K,IAAU,QACLgB,KAAK,QAAS8K,GACd9K,KAAK,SAAU+K,GACf/K,KAAK,YAHV,qBAGqC,IAAM8K,GAAa,EAHxD,YAG0E,IAAbC,EAH7D,MAKkC,KAAvBzM,KAAKjC,MAAM8B,KAAK4L,KAC3B/K,IAAU,UACLgB,KAAK,QAAS8K,GACd9K,KAAK,SAAU+K,GACf/K,KAAK,YAHV,qBAGqC,IAAM8K,GAAa,EAHxD,aAG2E,IAAbC,EAH9D,MAUA,IAAIC,EAAM1M,KAAKjC,MAAM8B,KAAK8L,WAAa3L,KAAKjC,MAAM8B,KAAK6L,WAEvD1M,QAAQC,IAAIyN,GAEFhM,IAAU,SAASe,OAAO,OAC/BC,KAAK,QAASX,GAAOW,KAAK,SAAUP,GACpCO,KAAK,YAFA,uBAE2C,MAAX,IAAIgL,GAFpC,MAINjL,OAAO,QACNC,KAAK,QAASX,GAAOW,KAAK,SAAU,KACpCA,KAAK,OAAQ,SACbA,KAAK,UAAW,O,+BAKrB,OACI,sBAAK9C,GAAG,aAAayE,UAAU,OAAOX,MAAO,CAACiK,SAAW,UAAzD,UACI,qBAAKtJ,UAAU,SAAf,gCAIA,eAAC,IAAD,CAAKuJ,QAAQ,eAAeC,MAAM,SAAlC,UAEI,cAAC,IAAD,CAAKC,KAAM,GAAIpK,MAAO,CAAEqK,WAAY,IAApC,SACI,cAAC,IAAD,UACI,qBAAKnO,GAAG,OAAO8D,MAAO,CAAEnB,OAAQ,IAAhC,mBASR,cAAC,IAAD,CAAKuL,KAAM,GAAX,SAEI,eAAC,IAAD,CAAcnJ,MAAO3D,KAAKjC,MAAMG,GAAIwE,MAAO,CAAEsK,QAAS,IAAtD,UACI,cAAC,IAAaC,KAAd,CAAmBC,MAAM,MAAMJ,KAAM,EAArC,SACK9M,KAAKjC,MAAM8B,KAAK4L,MAGrB,cAAC,IAAawB,KAAd,CAAmBC,MAAM,MAAMJ,KAAM,EAArC,SACK9M,KAAKjC,MAAM8B,KAAK+L,MAGrB,cAAC,IAAaqB,KAAd,CAAmBC,MAAM,aAAaJ,KAAM,EAA5C,SACK9M,KAAKjC,MAAM8B,KAAK6L,aAGrB,cAAC,IAAauB,KAAd,CAAmBC,MAAM,aAAaJ,KAAM,EAA5C,SACK9M,KAAKjC,MAAM8B,KAAK8L,aAGrB,cAAC,IAAasB,KAAd,CAAmBC,MAAM,YAAYJ,KAAM,EAA3C,SACK9M,KAAKjC,MAAM8B,KAAK8L,WAAa3L,KAAKjC,MAAM8B,KAAK6L,aAMlD,cAAC,IAAauB,KAAd,CAAmBC,MAAM,cAAcJ,KAAM,EAA7C,SACK9M,KAAKjC,MAAM8B,KAAKiM,cAGrB,cAAC,IAAamB,KAAd,CAAmBC,MAAM,iBAAiBJ,KAAM,EAAhD,SACK9M,KAAKjC,MAAM8B,KAAKgM,iBAGrB,cAAC,IAAaoB,KAAd,CAAmBC,MAAM,GAAzB,SACI,qBAAKnM,MAAO,GAAI2B,MAAO,GAAIyK,IAAKnN,KAAKjC,MAAMyN,uB,GAlLnCjI,aCQnB6J,G,yDAEnB,WAAYxN,GAAQ,IAAD,8BACjB,cAAMA,IACD7B,MAAQ,GAFI,E,qDAMjB,OAAS,gCAEP,eAAC,IAAD,CAAK2E,MACH,CACEvB,OAAQ,QAFZ,UAKA,eAAC,IAAD,CAAK2L,KACH,EAEFpK,MACE,CACEvB,OAAQ,QALZ,UAQA,cAAC,IAAD,CAAKuB,MACH,CACEvB,OAAQ,OAFZ,SAKA,cACA,EADA,MAGA,cAAC,IAAD,CAAKuB,MACH,CACEvB,OAAQ,OAFZ,SAKA,cACA,EADA,MArBA,OAwBA,eAAC,IAAD,CAAK2L,KACH,GAEFpK,MACE,CACEvB,OAAQ,QALZ,UAQA,cAAC,IAAD,CAAKuB,MACH,CACEvB,OAAQ,OAFZ,SAKA,cAAC,EAAD,MAEA,eAAC,IAAD,CAAKuB,MACH,CACEvB,OAAQ,OAFZ,UAKA,eAAC,IAAD,CAAK2L,KACH,GAEFpK,MACE,CACEvB,OAAQ,OACRkM,gBAAiB,QANrB,cAQI,cAAE,EAAF,IARJ,OALA,IAamC,eACnC,IADmC,CAC/BP,KACF,GAEFpK,MACE,CACEvB,OAAQ,QANuB,cAQ/B,cAAE,EAAF,IAR+B,UA5BnC,UAuCA,eAAC,IAAD,CAAKuB,MACH,CACEvB,OAAQ,OAGZvC,GAAK,SALL,UAMA,sBAAK8D,MACH,CACE4K,UAAW,UAFf,yBAKY,mBAAIC,KAAO,sCAAX,mDALZ,YAMO,mBAAIA,KAAO,IAAX,8CANP,QANA,OAtEO,W,GAR0BhK,cCVvCiK,IAASC,OAAO,cAAC,EAAD,IAAezM,SAASC,eAAe,W","file":"static/js/main.86392f5d.chunk.js","sourcesContent":["const state = {\r\n    familyInfo: [\r\n        {\r\n            key: 38,\r\n            ID: 38,\r\n            people: 121,\r\n            SNum: 12\r\n        },\r\n        {\r\n            key: 149,\r\n            ID: 149,\r\n            people: 113,\r\n            SNum: 10\r\n        },\r\n        {\r\n            key: 27251,\r\n            ID: 27251,\r\n            people: 404,\r\n            SNum: 39\r\n        },\r\n        {\r\n            key: 42623,\r\n            ID: 42623,\r\n            people: 81,\r\n            SNum: 10\r\n        },\r\n        {\r\n            key: 68939,\r\n            ID: 68939,\r\n            people: 244,\r\n            SNum: 23\r\n        },\r\n        {\r\n            key: 176860,\r\n            ID: 176860,\r\n            people: 426,\r\n            SNum: 44\r\n        },\r\n        {\r\n            key: 603481,\r\n            ID: 603481,\r\n            people: 181,\r\n            SNum: 19\r\n        },\r\n        {\r\n            key: 791533,\r\n            ID: 791533,\r\n            people: 114,\r\n            SNum: 10\r\n        },\r\n        {\r\n            key: 903988,\r\n            ID: 903988,\r\n            people: 58,\r\n            SNum: 5\r\n        }\r\n        \r\n    ],\r\n    focusFamily: 42623,\r\n    focusPID: 10787,\r\n    selectedFamily: [38, 149, 27251, 42623],\r\n}\r\n\r\nexport default state;","import state from \"./state\"\r\n\r\nconst reducers = (preState=state, action) => {\r\n    switch(action.type){\r\n        case 'ADD_FAMILY':\r\n            return {\r\n                ...preState,\r\n                selectedFamily: [...preState.selectedFamily, action.id],\r\n                focusFamily: action.id\r\n            }\r\n        case 'REMOVE_FAMILY':\r\n            return {\r\n                ...preState,\r\n                selectedFamily: preState.selectedFamily.filter((d)=>{return d !== action.id}),\r\n                focusFamily: modifyFocusFa(preState, action)\r\n            }\r\n        case 'SELECT_FAMILY':\r\n            return {\r\n                ...preState,\r\n                focusFamily: action.id\r\n            }\r\n        case 'SELECT_PERSON':\r\n            return {\r\n                ...preState,\r\n                focusPID: action.id\r\n            }\r\n        default:\r\n            return {\r\n                ...preState\r\n            }\r\n    }\r\n}\r\n\r\nexport default reducers;\r\n\r\nfunction modifyFocusFa(preState, action){\r\n    console.log(preState.selectedFamily[preState.selectedFamily.length-1])\r\n    return preState.selectedFamily[preState.selectedFamily.length-1] === action.id ? preState.selectedFamily[preState.selectedFamily.length-2]:preState.selectedFamily[preState.selectedFamily.length-1]\r\n}","import { createStore} from \"redux\";\r\nimport reducers from \"./reducers\";\r\n\r\n// 安装redux-devtools-extension的可视化工具。\r\nimport { composeWithDevTools } from 'redux-devtools-extension'\r\n\r\nconst store = createStore(reducers, \r\n    composeWithDevTools());\r\nexport default store;","\r\nconst actions = {\r\n    addFamily: function(id){\r\n        return {\r\n            type: 'ADD_FAMILY',\r\n            id\r\n        }\r\n    },\r\n    removeFamily: function(id){\r\n        return {\r\n            type: 'REMOVE_FAMILY',\r\n            id\r\n        }\r\n    },\r\n    selectFamily: function(id){\r\n        return {\r\n            type: 'SELECT_FAMILY',\r\n            id\r\n        }\r\n\r\n    },\r\n    selectPerson: function(id){\r\n        return {\r\n            type: 'SELECT_PERSON',\r\n            id\r\n        }\r\n\r\n    }\r\n}\r\n\r\nexport default actions;","import React, { Component } from 'react';\r\nimport * as d3 from \"d3\";\r\nimport './ScatterPlot.css';\r\nimport axios from 'axios';\r\n\r\n// 使用redux\r\nimport store from '../../redux/index'\r\nimport action from '../../redux/actions'\r\n\r\nexport default class ScatterPlot extends Component {\r\n\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {\r\n            data: [\r\n                [11,27,2],\r\n                [98,21,2],\r\n                [17,40,3],\r\n                [43,21,3],\r\n                [61,1,3],\r\n                [2,66,1],\r\n                [92,52,2],\r\n                [41,93,1],\r\n                [54,59,1],\r\n                [12,4,1],\r\n                [82,90,1],\r\n                [90,18,1],\r\n                [77,54,3],\r\n                [60,21,1],\r\n                [73,47,2],\r\n                [64,73,1],\r\n                [24,30,3],\r\n                [42,86,2],\r\n                [63,35,3],\r\n                [27,29,1],\r\n                [5,87,2],\r\n                [89,55,2],\r\n                [100,24,3],\r\n                [76,93,3],\r\n                [13,1,2],\r\n                [99,39,3],\r\n                [66,96,2],\r\n                [41,72,1],\r\n                [33,28,2],\r\n                [1,16,2],\r\n                [35,19,2],\r\n                [48,56,1],\r\n                [72,2,3],\r\n                [96,17,1],\r\n                [86,19,1],\r\n                [20,7,1],\r\n                [77,39,3],\r\n                [15,84,2],\r\n                [40,51,1],\r\n                [25,23,2],\r\n                [8,51,2],\r\n                [31,84,3],\r\n                [85,1,3],\r\n                [100,93,2],\r\n                [94,85,2],\r\n                [100,67,1],\r\n                [64,93,3],\r\n                [44,71,1],\r\n                [1,80,3],\r\n                [50,2,3],\r\n                [45,87,2],\r\n                [60,3,1],\r\n                [14,60,2],\r\n                [22,91,3],\r\n                [4,59,2],\r\n                [100,95,2],\r\n                [25,38,2],\r\n                [71,44,2],\r\n                [89,10,3],\r\n                [38,46,2],\r\n                [4,38,1],\r\n                [78,98,3],\r\n                [59,92,3],\r\n                [91,2,1],\r\n                [37,27,3],\r\n                [45,15,2],\r\n                [90,90,3],\r\n                [77,45,2],\r\n                [88,20,3],\r\n                [19,84,2],\r\n                [78,46,3],\r\n                [68,39,3],\r\n                [76,32,2],\r\n                [69,42,1],\r\n                [81,71,1],\r\n                [65,71,1],\r\n                [68,96,2],\r\n                [3,97,1],\r\n                [46,56,2],\r\n                [47,83,2],\r\n                [56,87,3],\r\n                [8,95,1],\r\n                [11,42,1],\r\n                [13,6,3],\r\n                [26,81,2],\r\n                [1,89,2],\r\n                [23,64,2],\r\n                [71,81,1],\r\n                [64,28,1],\r\n                [87,94,2],\r\n                [62,20,1],\r\n                [53,40,1],\r\n                [70,18,2],\r\n                [78,27,2],\r\n                [51,96,2],\r\n                [83,68,1],\r\n                [54,10,3],\r\n                [24,41,3],\r\n                [90,4,1],\r\n                [56,45,1]\r\n            ]\r\n        }\r\n    }\r\n\r\n    componentDidMount(){\r\n        store.subscribe(()=>{\r\n            this.drawChart()\r\n        })\r\n        this.uploadData()\r\n    }\r\n    \r\n    uploadData() {\r\n        const _this = this;\r\n        axios.get(\"http://106.52.126.175/api/getTsneview/\"\r\n        ).then((res) => {\r\n            // console.log(res);\r\n            let data = res.data;\r\n\r\n            _this.setState(\r\n                {\r\n                    data: data\r\n                }, () => {\r\n                    // console.log(this.state);\r\n                    _this.drawChart();\r\n                })\r\n        })\r\n    }\r\n    drawChart() {\r\n        var selectedF = store.getState().selectedFamily;\r\n        d3.select(\"#ScatterPlot svg\").remove()\r\n        const points = this.state.data.filter(d=>selectedF.indexOf(d.fid) !== -1)\r\n        const margin = 20\r\n        const marginRight = 90  // 定义右边距\r\n        const width = document.getElementById(\"ScatterPlot\").clientWidth\r\n        const height = document.getElementById(\"ScatterPlot\").clientHeight - 30\r\n        const innerWidth = width - margin - marginRight\r\n        const innerHeight = height - margin*2\r\n\r\n        const svg = d3.select(\"#ScatterPlot\")\r\n                        .append(\"svg\")\r\n                        .attr(\"preserveAspectRatio\", \"xMidYMid meet\")\r\n                        .attr(\"viewBox\", \"0 0 \" + width +\" \"+ height)\r\n\r\n        let x = d3.scaleLinear()\r\n            .domain([0, Math.max(...points.map(d => d.x))])\r\n            .range([0, innerWidth])\r\n\r\n        let y = d3.scaleLinear()\r\n            .rangeRound([0, innerHeight])\r\n            .domain([Math.max(...points.map(d => d.y)), 0])\r\n\r\n        let z = d3.scaleOrdinal()\r\n                .domain([\"38\", \"149\", \"27251\", \"42623\", \"68939\", \"176860\", \"603481\", \"791533\", \"903988\"])\r\n                .range(['#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6'])\r\n\r\n        let fig = svg.append('g')\r\n            .attr('transform', 'translate(' + 10 + ',' + 10 + ')')\r\n        let focusPerson = store.getState().focusPID\r\n        // console.log('focusPerson', focusPerson)\r\n\r\n        let $tooltip = d3.select('.plot-tooltip')\r\n        fig.append('g') // 输出点\r\n            .selectAll('circle')\r\n            // .attr('class', 'points')\r\n            .data(points)\r\n            .enter()\r\n            .append('circle')\r\n            .attr('cursor', 'pointer')\r\n            .attr('stroke', d=>d.pid == focusPerson? 'black': z(d.fid))\r\n            .attr('stroke-width', '1')\r\n            .attr('fill', function(d) {\r\n                return z(d.fid)\r\n            })\r\n            .attr('cx', function(d) {\r\n                return x(d.x)\r\n            })\r\n            .attr('cy', function(d) {\r\n                return y(d.y)\r\n            })\r\n            .attr('r', 6)\r\n            .style('opacity',\"0.6\")\r\n            .on('mouseover', function(d){\r\n                d3.select(this)\r\n                    .style('opacity', 1)\r\n\r\n                $tooltip.transition()\r\n                    .duration(100)\r\n                    .style('opacity', .7)\r\n\r\n                let coordinates = d3.mouse(this);\r\n                $tooltip.html( 'Family ID:  ' + d.fid + '<br/>'  + 'Persion ID: ' + d.pid)\r\n                    .style('left', (coordinates[0]+10)+'px')\r\n                    .style('top', (coordinates[1])+'px')\r\n            })\t\r\n            .on(\"mouseout\", function(d) {\r\n                d3.select(this)\r\n                    .style('opacity', 0.6)\r\n                \r\n                $tooltip.transition()\t\t\r\n                        .duration(200)\t\t\r\n                        .style(\"opacity\", 0);\t\r\n            })\r\n            .on('click', function(d){\r\n                store.dispatch(action.selectFamily(d.fid))\r\n                store.dispatch(action.selectPerson(d.pid))\r\n            })\r\n       \r\n        let legend = fig\r\n            .append('g') // 画legend\r\n            .attr('font-family', 'Arial')\r\n            .attr('font-size', \"12px\")\r\n            .attr(\"font-weight\",\"500\")\r\n            .attr('transform', `translate(${innerWidth+(margin/2)+10},0)`)\r\n            .attr('text-anchor', 'start')\r\n            .selectAll('g')\r\n            .data(store.getState().selectedFamily)\r\n            .enter()\r\n            .append('g')\r\n            .attr('transform', function(d, i) {\r\n                return 'translate(0,' + i * 25 + ')'\r\n            })\r\n            .on('click', d=>{\r\n                store.dispatch(action.selectFamily(d))\r\n            })\r\n            .attr('cursor', 'pointer')\r\n        \r\n        \r\n        var focusFamily = store.getState().focusFamily;\r\n        legend.each(function(d){\r\n            if(d === focusFamily){\r\n                d3.select(this)\r\n                    .append('rect')\r\n                    .style(\"fill\", '#bbb')\r\n                    .attr('width', 75)\r\n                    .attr('height', 20)\r\n                    .style(\"opacity\", '0.7')\r\n                    .attr('rx', 5)\r\n                    .attr('x', -5)\r\n                    .attr('y', -4)\r\n                    .style(\"stroke-width\", 0.5);\r\n            }\r\n        })\r\n        legend\r\n            .append('circle')\r\n            .attr('r', 6)\r\n            .attr('cx', 6)\r\n            .attr('cy', 6)\r\n            .attr('fill', z)\r\n            .style(\"opacity\", d=>d === focusFamily? '1': '0.7')\r\n\r\n        legend\r\n            .append('text')\r\n            .attr('x', 18)\r\n            .attr('dy', 10)\r\n            .text(function(d) {\r\n                return \"F\" + d\r\n            })\r\n            .attr('fill', d=> d === focusFamily? '#fff': '#000')\r\n\r\n    }\r\n    render() {\r\n\r\n        return (\r\n            <div id='ScatterPlot' className='pane'>\r\n                <div className='header'>Scatter Plot</div>\r\n                <div class='plot-tooltip'></div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n","import React, { Component } from 'react';\r\nimport './FamilySelector.css';\r\nimport { Table, Tag, Space } from 'antd';\r\n// 使用redux\r\nimport store from '../../redux/index'\r\nimport action from '../../redux/actions'\r\n\r\nexport default class FamilySelector extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            dataSource: [],\r\n            columns: [\r\n                {\r\n                    title: 'ID',\r\n                    dataIndex: 'ID',\r\n                    key: 'ID'\r\n                },\r\n                {\r\n                    title: 'people',\r\n                    dataIndex: 'people',\r\n                    key: 'people'\r\n                },\r\n                {\r\n                    title: 'SNum',\r\n                    dataIndex: 'SNum',\r\n                    key: 'SNum'\r\n                }\r\n            ]\r\n        };\r\n    }\r\n    componentDidMount(){\r\n        this.setState({\r\n            dataSource: store.getState().familyInfo\r\n        }, ()=>{\r\n            this.setFocus();\r\n        });\r\n        store.subscribe(()=>{\r\n            this.setFocus();\r\n        })\r\n    }\r\n\r\n    setFocus(){\r\n        let focusFamily = store.getState().focusFamily;\r\n        let nodes = document.getElementsByClassName('ant-table-row');\r\n        console.log(nodes)\r\n        for(var i = 0; i < nodes.length; i++){\r\n            let key = nodes[i].getAttribute('data-row-key')\r\n            if(key == focusFamily){\r\n                nodes[i].classList.add('onFocus')\r\n            }else{\r\n                nodes[i].classList.remove('onFocus')\r\n            }\r\n        }\r\n    }\r\n    onRowClick(e){\r\n        console.log(e)\r\n    }\r\n\r\n    getElementByAttr(tag,attr,value){\r\n        var aElements=document.getElementsByTagName(tag);\r\n        var aEle=[];\r\n        for(var i=0;i<aElements.length;i++)\r\n        {\r\n            if(aElements[i].getAttribute(attr)==value)\r\n                aEle.push( aElements[i] );\r\n        }\r\n        return aEle;\r\n    }\r\n    render() {\r\n        return (\r\n            <div id='FamilySelector' className='pane'>\r\n                <div className='header'>Family Selector</div>\r\n                <Table \r\n                    onRow={record => {\r\n                        return {\r\n                            onClick: event => {\r\n                                console.log(record)\r\n                                let node = this.getElementByAttr('tr', 'data-row-key', record.key)[0];\r\n                                let nclasses = node.getAttribute('class');\r\n                                if(nclasses.indexOf('onSelect') == -1){ // 未选中 - 选中\r\n                                    node.classList.add('onSelect')\r\n                                    store.dispatch(action.addFamily(record.ID)) \r\n                                }else{                                  // 选中\r\n                                    if(nclasses.indexOf('onFocus') == -1){  // 选中，但未focus - focus\r\n                                        node.classList.add('onFocus')\r\n                                        store.dispatch(action.selectFamily(record.ID))\r\n                                    }else{\r\n                                        node.classList.remove('onSelect')   // 选中，且focus - 取消选中\r\n                                        store.dispatch(action.removeFamily(record.ID))\r\n                                    }\r\n                                }\r\n                            }\r\n                        };\r\n                    }}\r\n                    rowClassName={record => {\r\n                        return  store.getState().selectedFamily.indexOf(record.key) !== -1 ? 'onSelect' : '';\r\n                    }}\r\n                    dataSource={this.state.dataSource} columns={this.state.columns} size='small'\r\n                    pagination={{\r\n                        hideOnSinglePage: true,\r\n                        defaultPageSize: 10\r\n                    }}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n}","import React, { Component } from 'react';\r\nimport './FamilyTree.css';\r\nimport * as d3 from 'd3';\r\nimport store from '../../redux/index';\r\nimport axios from 'axios';\r\nimport action from '../../redux/actions'\r\n\r\nexport default class FamilyTree extends Component {\r\n\r\n  constructor(props){\r\n    super(props)\r\n    this.state = {\r\n      focusFamily: ''\r\n    }\r\n  }\r\n  componentDidMount(){\r\n    this.makeKey()\r\n    store.subscribe(()=>{\r\n        this.uploadData()\r\n    })\r\n    this.uploadData();\r\n  }\r\n  \r\n  uploadData() {\r\n    \r\n    const focusFamily = store.getState().focusFamily\r\n    axios.get(\"http://106.52.126.175/api/getFamilyTree/\"+'?fid='+focusFamily\r\n    ).then((res) => {\r\n        let data = res.data;\r\n        this.setState({\r\n            focusFamily: focusFamily\r\n        })\r\n        this.drawHorPro(data);\r\n    })\r\n}\r\n  \r\n  // 改进垂直树\r\n  drawHorPro(data){\r\n\r\n        // console.log('drawHorPro')\r\n        const width = document.getElementById(\"FamilyTree\").clientWidth\r\n        const height = document.getElementById(\"FamilyTree\").clientHeight-45-60\r\n    \r\n        var graphicOpt = {\r\n          width: width,\r\n          height: height,\r\n          margin: 20,\r\n        }\r\n    \r\n        let graphicOpt_radialC = {  //节点大小和颜色设置\r\n            width:16,\r\n            height:16,\r\n            color: d3.scaleOrdinal()\r\n                // .range(['#8dd3c7','#ffffb3','#bebada','#fb8072','#80b1d3','#fdb462','#b3de69','#fccde5','#d9d9d9','#bc80bd','#ccebc5','#ffed6f', \"silver\", \"teal\", \"black\", \"yellow\"])\r\n                .range([\"#8dd3c7\",\"#ffffb3\",\"#bebada\",\"#fb8072\",\"#80b1d3\",\"#fdb462\",\"#b3de69\",\"#fccde5\",\"#d9d9d9\",\"#bc80bd\",\"#ccebc5\",\"#ffed6f\",\"#eea60d\",\"#a9402a\",\"#845d54\",\"#056f1f\",\"#475e4c\"])\r\n        }\r\n    \r\n        d3.selection.prototype.moveToFront = function() {\r\n            return this.each(function(){\r\n                this.parentNode.appendChild(this);\r\n            });\r\n        };  \r\n        let dataLists =[];\r\n        \r\n        loadTree(0);\r\n    \r\n        function loadTree(isRight){\r\n          dataLists[+isRight] = {id: 'Tree'+(+isRight), data:data};\r\n          createHolder(dataLists)\r\n        }\r\n\r\n        // 添加SVG对象\r\n        function createHolder(listTree) { // [{id: family1, data: loaded from json}]\r\n          let holders = d3.select('#FamilyTree')\r\n              .selectAll('div.svgHolder')\r\n              .data(listTree, d=>d.id)\r\n              .call(updateHoders);\r\n          holders.exit().remove();\r\n          holders\r\n              .enter()\r\n              .append('div')\r\n              .attr('class','svgHolder')\r\n              .call(updateHoders);\r\n    \r\n          function updateHoders(p){\r\n              return p.attr('id',d=>d.id)\r\n                  .each(function(d){drawTree('#'+d.id, d.data, graphicOpt)});\r\n          }\r\n        }\r\n    \r\n        function drawTree(holder, data, graphicOpt) {\r\n          // 定义画布维度和边界\r\n          var width = graphicOpt.width;\r\n          var height = graphicOpt.height;\r\n          var margin = graphicOpt.margin; // dendrogram的直径\r\n          var pn = data.length < 60?1: data.length/60;\r\n        //   console.log(data.length, data.length/100, pn)\r\n          let div = d3.select(holder);\r\n          div.select('svg').remove()\r\n          var svg = div\r\n                    .append(\"svg\")\r\n                    .attr('id', 'treesvg')\r\n                    .attr(\"width\", width*pn)\r\n                    .attr(\"height\", height)\r\n                    .append(\"g\")\r\n                    .attr('class','content')\r\n                    .attr(\"transform\", \"translate(\" + margin + \",\" + margin + \")\");\r\n          svg.selectAll(\"*\").remove();\r\n          // 定义cluster(dendrogram)布局:\r\n          var cluster = d3.cluster()\r\n            //   .size([360, radius - 20]);  // 360指整个圆. radius-60指dendrogram周围有20个像素\r\n              .size([width*pn-margin*2, height-margin*3]);  //  [width, height]\r\n    \r\n          // 为cluster布局绑定数据:\r\n          var root = d3.stratify()\r\n              .id(function (d) {\r\n                  return d.id;\r\n              })\r\n              .parentId(function (d) {\r\n                  return d.parent;\r\n              })\r\n              (data);\r\n\r\n          cluster(root)\r\n    \r\n          // 节点与节点之间链接生成器\r\n          var linksGenerator = d3.linkVertical()\r\n                                .x(function(d) { return d.x; })\r\n                                .y(function(d) { return d.y; });\r\n    \r\n          // 在节点间添加链接:\r\n          svg.selectAll('path')\r\n              .data(root.links())\r\n              .enter()\r\n              .append('path')\r\n              .attr(\"d\", linksGenerator)\r\n              .style(\"fill\", 'none')                                                                                                                                                                                                                                        \r\n              .attr(\"stroke\", '#ccc')\r\n            // console.log(root.links());\r\n    \r\n          // 为每个节点添加圆.\r\n          var node = svg.selectAll(\".node\")\r\n              .data(root.descendants())\r\n              .enter()\r\n              .append(\"g\")\r\n              .attr(\"class\", \"node\")\r\n              .attr(\"transform\", function (d) {\r\n                  return \"translate(\" + d.x +\",\"+ d.y + \")\";\r\n              });\r\n            // console.log(root.descendants()); \r\n    \r\n          let focusPerson = store.getState().focusPID\r\n          // 为每个节点画一或两个圆，需要对原数据进行修改，将原数据拆分成一或二长度的数组，再对数组中每个数据进行操作（画圆）\r\n          node.selectAll('circle').data(d => {\r\n              let datainput=[];\r\n              if (d.data.group === \"individual\")\r\n                  datainput = [{key: 'ind', data: [d.data]}];\r\n              else\r\n                  datainput = [{key: 'self', data: [d.data]}, {key: 'spouse', data: d.data.spouse}];\r\n              if(d.data.children){\r\n                datainput.push({key: 'children', data: d.data.children})\r\n              }\r\n\r\n              return datainput.filter(p => p.data.filter(pp => !pp.clinical_data )); // 只针对未自杀或自杀却没有临床属性数据的\r\n            }).enter()\r\n              .append('g')\r\n              .attr('transform',d=>{\r\n                let rad = d.key === 'individual'?3:8;\r\n                let par = d.key === 'individual'?2.8:2.2;\r\n                let x = 0, y = 0;\r\n                if(d.key === 'spouse'){\r\n                    x = rad*par;\r\n                }\r\n                if(d.key === 'children'){\r\n                    x -= d.data.length%2 == 0 ? (d.data.length/2)*rad-rad/2 : Math.floor((d.data.length/2))*rad;\r\n                    y = 15;\r\n                }\r\n                return `translate(${x}, ${y})`\r\n              })\r\n              .selectAll('g')\r\n              .data(d => d.data)\r\n              .enter()\r\n              .append('g')\r\n              .attr('transform',(d, i)=>{\r\n                let rad = d.group === 'individual'?3:8;\r\n                let par = d.group === 'individual'?2.8:2.2;\r\n                let x = i*rad*par, y = 0;\r\n                if(d.sex === 'M' ){\r\n                    x -= rad;\r\n                    y -= rad;\r\n                }\r\n                return `translate(${x}, ${y})`\r\n              })\r\n              .on('mouseover',function(d){\r\n                  $tooltip.transition()\r\n                      .duration(100)\r\n                      .style('opacity', .85)\r\n\r\n                  let html = \"ID: \" + d.id + '<br/>';\r\n\r\n                  let coordinates = d3.mouse(container);\r\n\r\n                  $tooltip.html(html)\r\n                      .style('left', (coordinates[0]-20)+'px')\r\n                      .style('top', (coordinates[1]-30)+'px')\r\n\r\n              }).on('mouseout',function(){\r\n                  \r\n                  $tooltip.transition()\t\t\r\n                          .duration(200)\t\t\r\n                          .style(\"opacity\", 0);\t\r\n              })\r\n              .each(function(d){\r\n                  let coupleholder =  d3.select(this);\r\n                  let rad = d.group === 'individual'?3:8;\r\n                  if(d.sex === 'F'){ \r\n                    coupleholder.append('circle')\r\n                                .attr(\"r\", rad)\r\n                  }else{\r\n                    coupleholder.append('rect')\r\n                                .attr(\"width\", rad*2)\r\n                                .attr(\"height\", rad*2)\r\n                  }\r\n              })\r\n              .style(\"fill\", function (d) {\r\n                  if (d.is_suicide == 'Y') { //自杀的人（却没有临床属性数据），红色\r\n                      return \"red\"\r\n                  }\r\n                  if (d.is_deceased == 'Y') {\r\n                      return \"black\"\r\n                  } else {\r\n                      return \"#69b3a2\"\r\n                  }\r\n    \r\n              })\r\n              .attr(\"stroke\", \"#999\")\r\n              .style(\"stroke-width\", .5);\r\n\r\n          let $tooltip = d3.select('.tree-tooltip')\r\n          let container = d3.select('#FamilyTree').node()\r\n          node  // 针对自杀且有临床属性数据的，使用饼图进行绘制\r\n              .selectAll('g.personRadial').data(d => {\r\n                let datainput=[];\r\n                if (d.data.group === \"individual\")\r\n                    datainput = [{key: 'ind', data: d.data}];\r\n                else\r\n                    datainput = [{key: 'self', data: d.data}, {key: 'spouse', data: d.data.spouse[0]}];\r\n      \r\n                return datainput.filter(p => p.data.clinical_data );\r\n              }).enter()\r\n                .append('g')\r\n                .attr('class','personRadial')\r\n                .attr('transform',d=>{\r\n                  let rad = d.key === 'individual'?3:8;\r\n                  let par = d.group === 'individual'?2.8:2.2;\r\n                  let x = 0, y = 0; \r\n                  if(d.key === 'spouse'){\r\n                    x = rad*par;\r\n                  }\r\n                  return `translate(${x}, ${y})`\r\n                })\r\n                .attr('cursor', 'pointer')\r\n                .attr('transform', d=>d.data.id == focusPerson? 'scale(2)': 'scale(1)')\r\n                .on('mouseover',function(d){\r\n                    if(d.data.id != focusPerson){\r\n                      d3.select(this.parentNode).moveToFront();\r\n                      d3.select(this).select('g').attr('transform','scale(4)');\r\n                    }else{\r\n                      d3.select(this).select('g').attr('transform','scale(2)');\r\n                    }\r\n\r\n                    $tooltip.transition()\r\n                        .duration(100)\r\n                        .style('opacity', .85)\r\n\r\n                    let html = \"ID: \" + d.data.id + '<br/>';\r\n                    let cli_d = d3.entries(d.data.clinical_data)\r\n                    let count = 1;              //计算不为零的临床属性的个数\r\n                    for (let i in cli_d){       //i为下标\r\n                      let key = cli_d[i].key;\r\n                      let value = cli_d[i].value;\r\n                        if(value !== 0){\r\n                          html += \"<br/><svg width='10', height='10'><rect width='10', height='10', rx='2', style='fill:\" + graphicOpt_radialC.color(key) + \"'></svg> \" + key + \": \" + value;\r\n                          count++;\r\n                        }\r\n                    }\r\n\r\n                    let coordinates = d3.mouse(container);\r\n                    // console.log(coordinates)\r\n                    $tooltip.html(html)\r\n                        .style('left', (coordinates[0]-20)+'px')\r\n                        .style('top', (coordinates[1]-count*15-30)+'px')\r\n\r\n                }).on('mouseout',function(){\r\n                    d3.select(this).select('g').attr('transform','scale(1)');\r\n                    \r\n                    $tooltip.transition()\t\t\r\n                            .duration(200)\r\n                            .style(\"opacity\", 0);\t\r\n                })\r\n                .on('click', function(d){\r\n                    store.dispatch(action.selectPerson(d.data.id))\r\n                })\r\n                .each(function(d){\r\n                    // 画饼图\r\n                    drawRadialChart({holder: d3.select(this),    //在该遍历数据及元素上绘制\r\n                                     d: d.data,\r\n                                     graphicopt: graphicOpt_radialC})\r\n                })\r\n        }\r\n    \r\n        function drawRadialChart({holder, d, graphicopt}) {\r\n          let width = graphicopt.width;\r\n          let height = graphicopt.height;\r\n          let barHeight = height / 2;\r\n          let color = graphicopt.color;\r\n          let g = holder.append(\"g\")\r\n        \r\n          var data = d3.pie().value(d=>d.value)(d3.entries(d.clinical_data));\r\n    \r\n          var arc = d3.arc()\r\n              .innerRadius(0)\r\n              .outerRadius(barHeight);\r\n          \r\n          if(d.sex === 'M' ){\r\n            arc.outerRadius(Math.sqrt(2)*barHeight);\r\n            g.append(\"circle\")\r\n                .attr(\"r\", Math.sqrt(2)*barHeight)\r\n            g.append('rect')\r\n                    .attr('x', -barHeight)\r\n                    .attr('y', -barHeight)\r\n                    .attr('width', barHeight*2)\r\n                    .attr('height', barHeight*2)\r\n                    .style(\"fill\", \"white\")\r\n                    .style(\"stroke\", \"red\")\r\n                    .style(\"stroke-width\", 0.5);\r\n            \r\n            //蒙版\r\n            g.append('clipPath')\r\n                .attr('id', 'mark-area')\r\n                .append('rect')\r\n                .attr('x', -barHeight)\r\n                .attr('y', -barHeight)\r\n                .attr('width', barHeight*2)\r\n                .attr('height', barHeight*2)\r\n            g.attr('clip-path', 'url(#mark-area)')\r\n          }else{\r\n            g.append(\"circle\")\r\n                .attr(\"r\", barHeight)\r\n                .classed(\"outer\", true)\r\n                .style(\"fill\", \"white\")\r\n                .style(\"stroke\", \"red\")\r\n                .style(\"stroke-width\", 0.5);\r\n\r\n          }\r\n        \r\n          var segments = g.selectAll(\"path\")\r\n            .data(data)\r\n            .enter().append(\"path\")\r\n            .style(\"fill\", function (d) {\r\n                return color(d.data.key);\r\n            })\r\n            .attr(\"d\", arc)\r\n        }\r\n\r\n    }\r\n\r\n    makeKey(){\r\n      var margin_left = 60;\r\n      var width = document.getElementById(\"FamilyTree\").clientWidth-margin_left\r\n      var keys = [\r\n          \"alcohol\",\"psychosis\",\"anxiety-non-trauma\",\"somatic disorder\", \"eating\", \r\n          \"bipolar spectrum illness\",\"depression\",\"interpersonal trauma\",\"PD-Cluster C-anxiety\",\"PD-Cluster B-emotional\",\r\n          \"PD\",\"Impulse control disorder\",\"obesity\",\"cardiovascular\",\"COPD\",\"asthma\",\"immune-autoimmune\"]\r\n\r\n      var colors = [\"#8dd3c7\",\"#ffffb3\",\"#bebada\",\"#fb8072\",\"#80b1d3\",\"#fdb462\",\"#b3de69\",\"#fccde5\",\"#d9d9d9\",\"#bc80bd\",\"#ccebc5\",\"#ffed6f\",\"#eea60d\",\"#a9402a\",\"#845d54\",\"#056f1f\",\"#475e4c\"]\r\n\r\n      var group = d3.select(\"#legendsvg\")\r\n                  .attr('height', 60)\r\n                  .attr('width', width)\r\n                  .append(\"g\")\r\n                  .attr('class', 'legends')\r\n                  .selectAll('g')\r\n                  .data(keys)\r\n                  .enter()\r\n                  .append('g').attr('class', 'keysgroup')\r\n                  .attr('transform', (d, i)=>`translate(${60 + (i%8)*148}, ${Math.floor(i/8)*20})`)\r\n      group\r\n          .append('rect')\r\n          .attr('width', 12)\r\n          .attr('height', 12)\r\n          .attr(\"rx\", 4)\r\n          .style(\"fill\", (d, i)=>colors[i])\r\n      group.append('text')\r\n          .attr(\"y\", '0.9em')\r\n          .attr(\"dx\", 15)\r\n          .style(\"font-size\", \"12px\")\r\n          .text(d=>d);\r\n  }\r\n\r\n    render() {\r\n        return (\r\n          <>\r\n            <div id='FamilyTree' className='pane' >\r\n                <div className='header'>Family Tree : F{this.state.focusFamily}</div>\r\n                <div class='legend-div'>\r\n                  <svg id='legendsvg'></svg>\r\n                </div>\r\n                <div class='tree-tooltip'></div>\r\n            </div>\r\n          </>\r\n        )\r\n    }\r\n}","import React, {\r\n  Component\r\n} from 'react';\r\nimport * as d3 from \"d3\";\r\nimport './AttributesHeatmap.css';\r\nimport store from '../../redux/index';\r\nimport axios from 'axios';\r\nimport action from '../../redux/actions'\r\n\r\nexport default class AttributesHeatmap extends Component {\r\n\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      names: [\"m0\", \"m1\", \"m2\", \"m3\", \"m4\"], //家族人名\r\n      attrs: [\"alcohol\", \"psychosis\", \"anxiety-non-trauma\", \"somatic disorder\", \"eating\", \"bipolar spectrum illness\", \"depression\", \"interpersonal trauma\", \"PD-Cluster C-anxiety\", \"PD-Cluster B-emotional\", \"PD\", \"Impulse control disorder\", \"obesity\", \"cardiovascular\", \"COPD\", \"asthma\", \"immune-autoimmune\"], //临床属性 17个\r\n\r\n      attrsmap: {\r\n        \"alcohol\": 0,\r\n        \"psychosis\": 1,\r\n        \"anxiety-non-trauma\": 2,\r\n        \"somatic disorder\": 3,\r\n        \"eating\": 4,\r\n        \"bipolar spectrum illness\": 5,\r\n        \"depression\": 6,\r\n        \"interpersonal trauma\": 7,\r\n        \"PD-Cluster C-anxiety\": 8,\r\n        \"PD-Cluster B-emotional\": 9,\r\n        \"PD\": 10,\r\n        \"Impulse control disorder\": 11,\r\n        \"obesity\": 12,\r\n        \"cardiovascular\": 13,\r\n        \"COPD\": 14,\r\n        \"asthma\": 15,\r\n        \"immune-autoimmune\": 16\r\n      }, //临床属性17个键值对\r\n\r\n\r\n      allTimes: [1, 2, 4],\r\n\r\n      values: []\r\n    }\r\n\r\n  }\r\n\r\n  componentDidMount() {\r\n    store.subscribe(() => {\r\n      this.uploadData()\r\n    })\r\n    this.uploadData();\r\n\r\n  }\r\n\r\n  uploadData() {\r\n    const focusFamily = store.getState().focusFamily\r\n    axios.get(\"http://106.52.126.175/api/getAttrview/\" + '?fid=' + focusFamily).then((res) => {\r\n      let data = res.data;\r\n      // console.log(\"attr\", data)\r\n      this.setData(data)\r\n      document.getElementById(\"BarChart\").innerHTML = ''\r\n      document.getElementById(\"Heatmap\").innerHTML = ''\r\n      this.drawChart()\r\n    })\r\n  }\r\n\r\n  setData(data) {\r\n    // console.log(data)\r\n    let row = 0;\r\n    let myData = []\r\n    let allCount = []\r\n    let names = []\r\n\r\n\r\n    for (let i = 0; i < data.length; i++) {\r\n\r\n      let objNum = Object.values(data[i]).filter((value) => {\r\n        return typeof value === 'number';\r\n      });\r\n      objNum = objNum.slice(2)\r\n      //求数组值的和\r\n      let count = objNum.reduce((a, b) => a + b, 0)\r\n      if (count !== 0) {\r\n        names.push(data[i].pid)\r\n        let j = -2; // 除去前面2个id属性\r\n        for (let key in data[i]) {\r\n          //  console.log(key,data[i][key],j) // 每个小格子\r\n          if (j >= 0) {\r\n            myData.push({\r\n              row: row,\r\n              col: j,\r\n              times: data[i][key]\r\n            })\r\n          }\r\n          j++;\r\n        }\r\n        row++;\r\n      }\r\n    }\r\n\r\n    let data_count\r\n    // 柱状图统计\r\n    if (data.length) {\r\n      let data_keys = Object.keys(data[0]).filter(item => [\"pid\", \"fid\"].indexOf(item) < 0) //对象键映射\r\n      data_count = new Object()\r\n      data_keys.forEach(e => {\r\n        data_count[e] = data.map(item => {\r\n          return item[e]\r\n        }).reduce((a, b) => a + b, 0) //求和，初值0\r\n      });\r\n\r\n    }\r\n    // console.log(data_count)\r\n\r\n    let allTimes = Object.values(data_count).map(value => value) //对象的值映射，对象变数组\r\n    // console.log(allTimes) //\r\n\r\n    this.setState({\r\n      values: myData,\r\n      names: names,\r\n      allTimes: allTimes,\r\n    })\r\n  }\r\n\r\n  drawChart() {\r\n\r\n    // console.log(this.state.values)\r\n    const _this = this;\r\n    const width = document.getElementById(\"AttributesHeatmap\").clientWidth\r\n    // const height = document.getElementById(\"AttributesHeatmap\").clientHeight - 30\r\n\r\n\r\n    const gridSize = width * 0.87 / 17 //width\r\n    // const gridHeight = Math.floor(height / this.state.names.length) //格子高度\r\n\r\n    const height = this.state.names.length * gridSize + 20;\r\n    const height1 = document.getElementById(\"AttributesHeatmap\").clientHeight * 0.18\r\n\r\n    const margin = {\r\n      top: 5,\r\n      bottom: 10,\r\n      left: 10,\r\n      right: 10\r\n    }\r\n\r\n    //let maxTimes = Math.max.apply(Math,this.state.allTimes.map(item => {return item.times}))\r\n\r\n    let times = this.state.values.map(item => {\r\n      return item.times\r\n    })\r\n    // console.log(d3.max(times))\r\n\r\n    //颜色\r\n    const color = d3.scaleLinear()\r\n      .domain([0, d3.max(times)])\r\n      //.domain([0, 4])\r\n      .range(['white', \"#2171b5\"])\r\n\r\n    const colors = [\"#8dd3c7\", \"#ffffb3\", \"#bebada\", \"#fb8072\", \"#80b1d3\", \"#fdb462\", \"#b3de69\", \"#fccde5\", \"#d9d9d9\", \"#bc80bd\", \"#ccebc5\", \"#ffed6f\", \"#eea60d\", \"#a9402a\", \"#845d54\", \"#056f1f\", \"#475e4c\"]\r\n\r\n\r\n\r\n    /* ----------------------------柱状图------------------------  */\r\n\r\n\r\n\r\n    // 文字legend\r\n    const height2 = height1 * 2 - 20;\r\n    const svg2 = d3.select(\"#BarChart\").append('svg')\r\n      .attr(\"width\", width).attr(\"height\", height2)\r\n      .attr('id', 'barlabel')\r\n    // .attr('transform', `translate(0, 0)`)\r\n\r\n    const text_g = svg2.append(\"g\")\r\n    // .attr(\"transform\", \"translate(12,16)\");\r\n\r\n    let attrLabels = text_g.selectAll(\".attrLabels\")\r\n      .data(this.state.attrs)\r\n      .enter()\r\n      .append(\"g\")\r\n      .attr('transform', (d, i) => `translate(${i * gridSize + width*0.085 + gridSize/3}, ${height2})`) // 直接transform <g>\r\n\r\n    attrLabels.append(\"text\")\r\n      .text(d => d)\r\n      .attr(\"font-size\", \"8pt\")\r\n      .attr(\"fill\", \"#595959\")\r\n      .attr(\"transform\", \"rotate(-75)\")\r\n\r\n    // x轴\r\n\r\n    //  const types = ['1', '2', ' 3', ' 4', '5', '6', '7',' 8','9','10','11', '12', '13 ','14','15','16','17']\r\n    //  let xScale = d3.scaleBand()\r\n    //     .domain(types)\r\n    //     .range([0, axisWidth]\r\n\r\n    const tooltip = d3.select(\".heatmap-tooltip\")\r\n    //.attr(\"transform\", \"translate(10,150)\")\r\n\r\n    const svg1 = d3.select(\"#BarChart\").append('svg')\r\n      .attr(\"width\", width).attr(\"height\", height1 + 5)\r\n\r\n    //let axisWidth = width - margin.left - margin.right - 70\r\n\r\n    //let axisWidth = width - 70\r\n    let axisWidth = width * 0.87\r\n    let xScale = d3.scaleLinear()\r\n      .domain([0, 17])\r\n      .range([0, axisWidth])\r\n\r\n    let axis = d3.axisBottom(xScale) //定义一个axis，由bottom可知，是朝下的\r\n      .ticks(17); //设置刻度数目 当使用 band 和 point 比例尺时没有作用 \r\n\r\n    let xAxis = svg1.append(\"g\")\r\n      .attr('transform', `translate(${width*0.085}, ${height1 })`)\r\n      .call(axis)\r\n\r\n    const yScale = d3.scaleLinear()\r\n      .domain([0, d3.max(this.state.allTimes)])\r\n      .range([height1, 0]);\r\n\r\n    const g = svg1.append(\"g\")\r\n      .attr(\"transform\", `translate(${width*0.085}, 0)`);\r\n\r\n    // console.log(this.state.allTimes)\r\n    const gs = g.selectAll(\".bar\")\r\n      .data(this.state.allTimes)\r\n      .enter()\r\n      .append(\"g\")\r\n      .attr('class', 'bar')\r\n\r\n\r\n    const rectPadding = width * 0.015; //矩形之间的间隙 20\r\n    let container = d3.select(\"#AttributesHeatmap\").node()\r\n    let container1 = d3.select(\"#BarChart\").node()\r\n    let container2 = d3.select(\"#Heatmap\").node()\r\n\r\n\r\n    gs.append(\"rect\")\r\n      .attr(\"x\", function (d, i) {\r\n        //console.log(d, i)\r\n        return gridSize * i + gridSize * 0.1875\r\n      })\r\n      .attr(\"y\", function (d) {\r\n        //console.log(yScale(d));\r\n        return yScale(d);\r\n        //return yScale(d + 10);\r\n      })\r\n      .attr(\"width\", function () {\r\n        return gridSize * 0.625;\r\n      })\r\n      .attr(\"height\", function (d) {\r\n        // console.log(height1 - yScale(d));\r\n        return height1 - yScale(d);\r\n      })\r\n      .attr(\"fill\", \"#91c0db\")\r\n      .on(\"mousemove\", function (d, i) {\r\n        let coordinates = d3.mouse(container1);\r\n        tooltip.style(\"left\", (coordinates[0] + 10) + 'px')\r\n          .style(\"top\", (coordinates[1] + 10) + 'px')\r\n          .style(\"display\", \"inline-block\")\r\n          .html(_this.state.attrs[i] + \"<br>\" + \"sum:\" + d)\r\n          .style(\"opacity\", .9);\r\n      })\r\n      .on(\"mouseout\", function (d) {\r\n        tooltip.style(\"display\", \"none\").style(\"opacity\", 0);\r\n      });\r\n\r\n\r\n\r\n\r\n    /* ----------------------------热力图------------------------  */\r\n\r\n    const svg = d3.select(\"#Heatmap\").append('svg')\r\n      .attr(\"width\", width).attr(\"height\", height)\r\n      .attr('id', 'heatmap')\r\n\r\n    //圆形+字母 legends\r\n\r\n    let focusPerson = store.getState().focusPID\r\n    const nameLabels = svg.append('g')\r\n      .attr('class', 'nameLabel')\r\n      .attr(\"transform\", \"translate(5, \" + (5 + gridSize / 2) + \")\")\r\n      .selectAll(\"text\")\r\n      .data(this.state.names)\r\n      .enter()\r\n      .append(\"text\")\r\n      .text(d => d)\r\n      .attr(\"x\", 0)\r\n      .attr(\"y\", function (d, i) {\r\n        return i * gridSize;\r\n      })\r\n      .attr(\"font-size\", \"8.5pt\")\r\n      .attr('cursor', 'pointer')\r\n      .attr(\"fill\", d=> d == focusPerson?\"#2171b5\": \"#595959\")\r\n      .on('click', (d)=>{\r\n          store.dispatch(action.selectPerson(d))\r\n      })\r\n\r\n\r\n\r\n    const cards = svg.append('g')\r\n      .attr(\"transform\", `translate(${width*0.085}, 0)`)\r\n      .attr('class', 'heatcards')\r\n      .selectAll(\"rect\")\r\n      .data(this.state.values)\r\n      .enter()\r\n\r\n    //console.log(cards)\r\n\r\n    //  .enter().append(\"rect\")\r\n    console.log(this.state.values)\r\n\r\n    const cardsEnter = cards.append(\"rect\")\r\n      .attr(\"x\", function (d, i) {\r\n        return width * 0.87 / 17 * d.col + 2\r\n      })\r\n      .attr(\"y\", function (d) {\r\n        return (d.row) * gridSize;\r\n      })\r\n      .attr(\"rx\", 4)\r\n      .attr(\"ry\", 4)\r\n      .attr(\"width\", gridSize - 5)\r\n      .attr(\"height\", gridSize - 5)\r\n      .attr('stroke', d=>this.state.names[d.row] == focusPerson? 'black': 'none')\r\n      .attr('stroke-width', d=> d.times == 0? '0':'0.3')\r\n      .style(\"fill\", function (d) {\r\n        return color(d.times);\r\n      })\r\n      .attr('cursor', 'pointer')\r\n      .on('click', (d)=>{\r\n          store.dispatch(action.selectPerson(this.state.names[d.row]))\r\n      })\r\n      .on(\"mousemove\", function (d, i) {\r\n        let coordinates = d3.mouse(container2);\r\n        // let coordinates = this.setMouse(d3.mouse(this))\r\n        // console.log(coordinates)\r\n\r\n        tooltip.style(\"left\", (coordinates[0] + 10) + 'px')\r\n          .style(\"top\", (coordinates[1] + 150) + 'px')\r\n          .style(\"display\", \"inline-block\")\r\n          .html(_this.state.attrs[d.col] + \"<br>\" + d.times)\r\n          .style(\"opacity\", .9);\r\n        // console.log(tooltip)\r\n      })\r\n      .on(\"mouseout\", function (d) {\r\n        tooltip.style(\"display\", \"none\").style(\"opacity\", 0);\r\n      });\r\n\r\n    // console.log(heatmap)\r\n  }\r\n\r\n\r\n\r\n  render() {\r\n    const {\r\n      data\r\n    } = this.props;\r\n    return ( \r\n    <>\r\n        <div className = 'header' > Attributes Heatmap </div>\r\n\r\n        <div id = 'AttributesHeatmap'\r\n        className = 'pane' >\r\n\r\n        <div className = 'heatmap-tooltip'\r\n        style = {\r\n          {\r\n            opacity: 0\r\n          }\r\n        }> </div>\r\n\r\n        <div id = 'BarChart' > </div>\r\n\r\n        <div id = 'Heatmap'\r\n        style = {\r\n          {\r\n            overflowX: \"hidden\"\r\n          }\r\n        }> </div> {\r\n        /* <BarChart data={data} width={1000} height={550}/> */\r\n      }\r\n      </div> \r\n    </>\r\n\r\n  )\r\n}\r\n}","import React, { Component } from 'react';\r\nimport * as d3 from \"d3\";\r\nimport './DetailInfo.css';\r\nimport { Row, Col, List, Descriptions} from 'antd';\r\nimport store from '../../redux/index';\r\nimport axios from 'axios';\r\n\r\nexport default class DetailInfo extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.state = {\r\n            ID: 'ID: ',\r\n            img:\"./img/ASPHYXIA.jpg\",\r\n            data: {\r\n                ID: 133,\r\n                Sex: 'M',\r\n                Birth_Year: 1900,\r\n                Death_Year: 1950,\r\n                BMI: 25,\r\n                Suicide_Weapon: 'Rope',\r\n                Death_Cause:'Acute carbon monoxide poisoning',\r\n                suicide_glyphs:''\r\n            },\r\n\r\n\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n    componentDidMount() {\r\n        store.subscribe(() => {\r\n            this.uploadData()\r\n        })\r\n        this.uploadData()\r\n    }\r\n\r\n\r\n    uploadData() {\r\n        const focusPID = store.getState().focusPID\r\n        axios.get(\"http://106.52.126.175/api/getDetailInfo/\" + '?pid=' + focusPID\r\n        ).then((res) => {\r\n            let data = res.data;\r\n            console.log(\"detailInfo\", data)\r\n            // if (data.maxbmi == 0) {\r\n            //     data.maxbmi = 22\r\n            // }\r\n            this.setState({\r\n                ID: 'ID: ' + data.pid,\r\n                img: \"./img/\" + data.suicide_glyphs + \".png\",\r\n                data: {\r\n                    ID: data.pid,\r\n                    Sex: data.sex,\r\n                    Birth_Year: data.bdate.slice(0,4),\r\n                    Death_Year: data.ddate.slice(0,4),\r\n                    BMI: data.maxbmi.toPrecision(4), //保留四位有效数字\r\n                    Suicide_Weapon: data.weapon,\r\n                    Death_Cause: data.cause_death,\r\n                    \r\n                },\r\n    \r\n            })\r\n            // document.getElementById(\"BarChart\").innerHTML = ''\r\n            // document.getElementById(\"Heatmap\").innerHTML = ''\r\n            this.drawChart()\r\n        })\r\n    }\r\n\r\n    drawChart() {\r\n\r\n        // preserveAspectRatio=\"none\" 不保留长宽比例\r\n        const man_body = '<svg preserveAspectRatio=\"none\" id=\"man\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"2940\" width=\"200\" height=\"200\"><path d=\"M512 88m-88 0a88 88 0 1 0 176 0 88 88 0 1 0-176 0Z\" fill=\"#333333\" p-id=\"2941\"></path><path d=\"M744.9 619.6c-21.3 5.7-43.3-6.9-49-28.3l-64.1-239c-1.2-4.5-7.9-3.6-7.9 1V1008c0 8.8-7.2 16-16 16h-64c-8.8 0-16-7.2-16-16V640c0-8.8-7.2-16-16-16s-16 7.2-16 16v368c0 8.8-7.2 16-16 16h-64c-8.8 0-16-7.2-16-16V353.3c0-4.7-6.7-5.6-7.9-1l-64.1 239c-5.7 21.3-27.7 34-49 28.3-21.3-5.7-34-27.6-28.3-49l69.5-260C339 240.7 402.4 192 474.8 192h74.3c72.5 0 135.9 48.7 154.6 118.7l69.5 260c5.7 21.3-6.9 43.2-28.3 48.9z\" fill=\"#333333\" p-id=\"2942\"></path></svg>'\r\n\r\n        const woman_body = '<svg preserveAspectRatio=\"none\" id=\"woman\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"2987\" width=\"225\" height=\"225\"><path d=\"M529.218 234.374c43.289 0 81.292 28.8 93 70.475l59.925 213.319c3.427 12.199-3.685 24.867-15.884 28.294-2.02 0.567-4.107 0.855-6.205 0.855-17.951 0-33.758-11.825-38.826-29.046l-53.568-182.01h-16.407l95.16 333.52h-87.43v244.56c0 19.694-15.966 35.659-35.66 35.659-19.693 0-35.658-15.965-35.658-35.659v-244.56h-17.112v245.697c0 18.983-15.39 34.372-34.372 34.372h-0.15c-19.09-0.084-34.522-15.583-34.522-34.673V669.78h-90.078l95.242-333.519h-14.872l-51.123 180.873c-5.047 17.855-21.342 30.183-39.897 30.183-13.136 0-23.785-10.649-23.785-23.785 0-2.17 0.297-4.329 0.882-6.418l59.465-212.205c11.687-41.706 49.705-70.535 93.017-70.535h98.858zM479.962 71c40.643 0 73.59 32.967 73.59 73.634 0 40.666-32.947 73.633-73.59 73.633s-73.59-32.967-73.59-73.633c0-40.667 32.947-73.634 73.59-73.634z\" fill=\"#333333\" p-id=\"2988\"></path></svg>'\r\n\r\n        let sex_icon;\r\n        if(this.state.data.Sex == 'M') {\r\n            sex_icon = man_body\r\n        } else if (this.state.data.Sex == 'F'){\r\n            sex_icon = woman_body\r\n        }\r\n        document.getElementById(\"body\").innerHTML = sex_icon\r\n\r\n        const height = document.getElementById(\"body\").clientHeight\r\n        const width = document.getElementById(\"body\").clientWidth\r\n\r\n        let bmi = this.state.data.BMI\r\n\r\n        if (bmi == 0) {\r\n            bmi = 22\r\n        }\r\n\r\n        //let new_width = 200;\r\n        let new_width = width * (bmi / 22)\r\n        let new_height = height * 0.9\r\n        console.log(bmi / 22, new_width)\r\n\r\n        if (this.state.data.Sex == 'M'){\r\n        d3.select(\"#man\")\r\n            .attr('width', new_width)\r\n            .attr(\"height\", new_height)\r\n            .attr(\"transform\", `translate(${(200 - new_width) / 2},${new_height * 0.05})`)\r\n            \r\n        } else if (this.state.data.Sex == 'F') {\r\n        d3.select(\"#woman\")\r\n            .attr('width', new_width)\r\n            .attr(\"height\", new_height)\r\n            .attr(\"transform\", `translate(${(200 - new_width) / 2}, ${new_height * 0.05})`)\r\n        }\r\n      \r\n\r\n        // -----------------  rect 透明蒙板 ------------------------\r\n        // console.log(this.state.data.ddate)\r\n        // console.log(this.state.data.bdate)\r\n        let age = this.state.data.Death_Year - this.state.data.Birth_Year\r\n\r\n        console.log(age)\r\n\r\n        let svg = d3.select(\"#body\").append('svg')\r\n            .attr(\"width\", width).attr(\"height\", height)\r\n            .attr(\"transform\", `translate(0, ${- (100-age) * 1.8})`);\r\n\r\n        svg.append(\"rect\")\r\n            .attr(\"width\", width).attr(\"height\", 200)\r\n            .attr(\"fill\", \"white\")\r\n            .attr(\"opacity\", 0.35)\r\n    }\r\n\r\n\r\n    render() {\r\n        return (\r\n            <div id='DetailInfo' className='pane' style={{overflow : \"hidden\"}}>\r\n                <div className='header'>Detail Information</div>\r\n\r\n                {/* <div id = 'info' style={{ left : 200}}>  </div> */}\r\n\r\n                <Row justify=\"space-around\" align=\"middle\">\r\n\r\n                    <Col span={10} style={{ paddingTop: 10 }}>\r\n                        <Row>                       \r\n                            <div id='body' style={{ margin: 10 }}> </div>                       \r\n                        </Row>\r\n\r\n                        {/* <Row>\r\n                        <img width={100} style={{}} src=\"./img/ASPHYXIA.jpg\"/>\r\n                        </Row> */}\r\n\r\n                    </Col>\r\n\r\n                    <Col span={14} >\r\n                    \r\n                        <Descriptions title={this.state.ID} style={{ padding: 10 }} >\r\n                            <Descriptions.Item label=\"Sex\" span={2}>\r\n                                {this.state.data.Sex}\r\n                            </Descriptions.Item>\r\n                            \r\n                            <Descriptions.Item label=\"BMI\" span={2}>\r\n                                {this.state.data.BMI}\r\n                            </Descriptions.Item>\r\n\r\n                            <Descriptions.Item label=\"Birth Year\" span={2}>\r\n                                {this.state.data.Birth_Year}\r\n                            </Descriptions.Item>\r\n                            \r\n                            <Descriptions.Item label=\"Death Year\" span={2}>\r\n                                {this.state.data.Death_Year}\r\n                            </Descriptions.Item>\r\n                            \r\n                            <Descriptions.Item label=\"Death Age\" span={4}>\r\n                                {this.state.data.Death_Year - this.state.data.Birth_Year}\r\n                            </Descriptions.Item>\r\n\r\n                    \r\n                            \r\n\r\n                            <Descriptions.Item label=\"Death Cause\" span={4}>\r\n                                {this.state.data.Death_Cause}\r\n                            </Descriptions.Item>\r\n\r\n                            <Descriptions.Item label=\"Suicide Weapon\" span={2}>\r\n                                {this.state.data.Suicide_Weapon}\r\n                            </Descriptions.Item>     \r\n\r\n                            <Descriptions.Item label=\"\"  >\r\n                                <img width={50} style={{}} src={this.state.img}/>\r\n                            </Descriptions.Item>\r\n                            \r\n                        </Descriptions>\r\n\r\n                    </Col>\r\n\r\n                    {/* <Col span={1}></Col> */}\r\n\r\n                </Row>\r\n\r\n            </div>\r\n        )\r\n    }\r\n}","import React, {\r\n  Component\r\n} from 'react';\r\nimport {\r\n  Row,\r\n  Col\r\n} from 'antd';\r\nimport ScatterPlot from './views/ScatterPlot';\r\nimport FamilySelector from './views/FamilySelector';\r\nimport FamilyTree from './views/FamilyTree';\r\nimport AttributesHeatmap from './views/AttributesHeatmap';\r\nimport DetailInfo from './views/DetailInfo';\r\nimport './dashboard.css';\r\n\r\n\r\nexport default class Dashboard extends Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {}\r\n  }\r\n\r\n  render() {\r\n    return ( <\r\n      div >\r\n      <Row style = {\r\n        {\r\n          height: '95vh'\r\n        }\r\n      } >\r\n      <Col span = {\r\n        6\r\n      }\r\n      style = {\r\n        {\r\n          height: '100%'\r\n        }\r\n      } >\r\n      <Row style = {\r\n        {\r\n          height: '40%'\r\n        }\r\n      } >\r\n      <\r\n      ScatterPlot / >\r\n      </Row> \r\n      <Row style = {\r\n        {\r\n          height: '60%'\r\n        }\r\n      } >\r\n      <\r\n      FamilySelector / >\r\n      </Row> </Col> \r\n      <Col span = {\r\n        18\r\n      }\r\n      style = {\r\n        {\r\n          height: '100%'\r\n        }\r\n      } >\r\n      <Row style = {\r\n        {\r\n          height: '60%'\r\n        }\r\n      } >\r\n      <FamilyTree / >\r\n      </Row> \r\n      <Row style = {\r\n        {\r\n          height: '40%'\r\n        }\r\n      } >\r\n      <Col span = {\r\n        13\r\n      }\r\n      style = {\r\n        {\r\n          height: '100%',\r\n          backgroundColor: \"#FFF\"\r\n        }\r\n      } > < AttributesHeatmap / > </Col> <\r\n      Col span = {\r\n        11\r\n      }\r\n      style = {\r\n        {\r\n          height: '100%'\r\n        }\r\n      } > < DetailInfo / > </Col> \r\n      </Row> </Col> \r\n      </Row> \r\n      <Row style = {\r\n        {\r\n          height: '5vh'\r\n        }\r\n      }\r\n      id = 'footer' >\r\n      <div style = {\r\n        {\r\n          textAlign: \"center\"\r\n        }\r\n      }>\r\n      Source Code < a href = 'https://github.com/Chacha-Z/FDepVis' > https: //github.com/Chacha-Z/FDepVis</a>;\r\n      Author < a href = '#' > 我来取个名 </a>; </div> </Row> </div>\r\n    )\r\n  }\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport 'antd/dist/antd.css';\r\nimport Dashboard from './Dashboard';\r\n\r\nReactDOM.render(<Dashboard />, document.getElementById('root'));\r\n"],"sourceRoot":""}